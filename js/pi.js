!function(){function execute(code,log,executeWarn){if("false"==sessionStorage.getItem("trustWarn"))sessionStorage.setItem("trustWarn","true"),pi._tool.log(executeWarn,"warn chat",function(){execute(code,this),this.delete()});else try{eval(code),void 0!==log&&log.delete()}catch(e){pi._tool.log(e.toString(),"error chat"),setTimeout(function(){$("#chat-input-field")[0].value="/js "+code},250)}}var version="1.0.0-28";!function e(){function t(e,t){$("#pi-status span")[0].innerHTML="PI is loading..<br>"+e+"<br>Status: "+t}function o(e,t){$.ajax({url:e,success:function(e){t(e)},error:function(e){console.error("Failed to load commits for Plug-it from GitHub. Auto-update is therefore unavailable.\n"+e)}})}function i(){function e(e,t,o){var i=e[t];return e[t]=function(){o(arguments[0]),i.call(e,arguments[0])},{remove:function(){e[t]=i}}}function n(e){var t=h.user.toJSON();h.user.set({id:1,guest:!1,level:50,role:API.ROLE.HOST,gRole:API.ROLE.HOST},{silent:!0});var o=_.pick(h.room.toJSON(),"joined","minChatLevel");h.room.set({joined:!0,minChatLevel:0},{silent:!0});var i=Math.max;Math.max=function(){return 0},e(),Math.max=i,h.room.set(o,{silent:!0}),h.user.set(t,{silent:!0})}function r(){if(window.rcs&&window.rcs.plugSock&&window.rcs.plugSock.sock instanceof WebSocket)return window.rcs.plugSock.sock;var e,t=WebSocket.prototype.send;return WebSocket.prototype.send=function(o){-1!==this.url.indexOf("plug.dj")&&-1!==o.indexOf(p)?(e=this,WebSocket.prototype.send=t):t.call(this,o)},n(function(){h.chatFacade.sendChat(p)}),WebSocket.prototype.send=t,e}if("object"!=typeof a||"object"!=typeof s)return setTimeout(i,10);var l=(new Date).getTime(),c=API.getUser().gRole>=API.ROLE.MANAGER?200:3500,p="Plug-It Socket Intercept: "+Math.random(),d={script:"https://rawgit.com/Plug-It/pi/pre-release/js/pi.js",styles:{blue_css:"https://rawgit.com/Plug-It/pi/pre-release/css/blue.css",menu_css:"https://rawgit.com/Plug-It/pi/pre-release/css/menu.css",popout:"https://rawgit.com/Plug-It/pi/pre-release/css/popout.css",popout_blue:"https://rawgit.com/Plug-It/pi/pre-release/css/popout-blue.css",custom_ranks:"https://rawgit.com/Plug-It/pi/pre-release/css/custom-ranks.css",old_chat:"https://rawgit.com/Plug-It/pi/pre-release/css/old-chat.css",old_footer:"https://rawgit.com/Plug-It/pi/pre-release/css/old-footer.css",small_history:"https://rawgit.com/Plug-It/pi/pre-release/css/small-history.css",small_friends:"https://rawgit.com/Plug-It/pi/pre-release/css/small-friends.css",small_playlists:"https://rawgit.com/Plug-It/pi/pre-release/css/small-playlists.css"},images:{background:"https://raw.githubusercontent.com/Plug-It/pi/pre-release/img/background/non-official/Plug-It-old.jpg"},sounds:{notification:"https://raw.githubusercontent.com/Plug-It/pi/pre-release/sounds/notification.wav",jingle:"https://raw.githubusercontent.com/Plug-It/pi/pre-release/sounds/jingle.wav"},visu:["https://rawgit.com/WiBla/visu/master/hyperspace/index.html","https://rawgit.com/WiBla/visu/master/hyperspace2/index.html","https://rawgit.com/WiBla/visu/master/hyperspace2/index.html?color=random","https://rawgit.com/WiBla/visu/master/pong/index.html"],emotes:{twitch:"https://twitchemotes.com/api_cache/v2/global.json",twitchSub:"https://twitchemotes.com/api_cache/v2/subscriber.json",betterDiscord:"https://raw.githubusercontent.com/Jiiks/BetterDiscordApp/master/data/emotedata_bttv.json",betterTTV:"https://api.betterttv.net/emotes",tasty:"https://emotes.tastycat.org/emotes-full.json"}},u={autoW:!1,autoDJ:!1,keyboardShortcuts:!1,chatCommands:!0,autoHideLogs:!1,autoHideLogsAfter:10,betterMeh:!1,navWarn:!1,afk:!1,afkMessage:null,showVotes:!1,betterClearChatLimit:5,chatLimit:512,skipNextMediaInHistory:!1,showVideo:!0,scVisu:!1,roomStyle:!0,CSS:!1,customRanks:!1,languageFlags:!1,friendsIcons:!1,customBG:!1,customBGURL:null,oldChat:!1,oldFooter:!1,smallHistory:!1,smallFriends:!1,smallPlaylists:!1,showDeletedMsg:!1,confirmDelete:!1,gRoleCmdSelfDel:!0,userInfo:!1,stuckSkip:!1,songLimit:!1,songLength:420,historyAlert:!1,systemNotifications:!1,songStats:!1,userJoin:!1,userLeave:!1,boothAlert:!1,boothPosition:3,userMeh:!1,userGrab:!1,guestJoin:!1,guestLeave:!1,friendRoomChange:!1,friendConnect:!1,friendDisconnect:!1,unfriended:!1,friendEventsList:{whiteList:{active:!1},blacklist:{active:!0,users:{3537523:{roomChange:!1,connect:!1,disconnect:!1,unfriended:!0}}}},gainNotification:!1,minimumGain:{xp:1,pp:2},userLevelUp:!1,bot:[5285179],discordbot:[20852061]},g={},m={afkResponder:l-6e4,voteShortcut:l-5e3},f={},h={},b={unread:!1,floodAPI:!1,woots:API.getUsers().filter(function(e){return 1==e.vote}),grabs:API.getUsers().filter(function(e){return e.grab}),mehs:API.getUsers().filter(function(e){return-1==e.vote}),chat:[]};Number.prototype.spaceOut=function(){return isNaN(this)||this<999?this:this.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")};var v=version,k=null;if(version.indexOf("-")){var y;v=(y=version.split("-"))[0],k=y[1]}var I=v.split("."),P=I[0],A=I[1],w=I[2];window.pi={version:{major:P,minor:A,patch:w,pre:k},_event:{advance:function(e){pi.autojoin(),e.dj&&e.media&&(API.getUser().id!==e.dj.id&&setTimeout(function(){pi.autowoot()},Math.ceil(10*Math.random()*1e3)),pi.songLimit(),pi.soundcloudVisu(e.media),u.songStats&&pi._tool.log(pi._tool.replaceString(a.info.songStats,{dj:e.lastPlay.dj.username,author:e.lastPlay.media.author,title:e.lastPlay.media.title,woots:e.lastPlay.score.positive,grabs:e.lastPlay.score.grabs,mehs:e.lastPlay.score.negative}),"info chat"),u.stuckSkip&&API.hasPermission(null,API.ROLE.BOUNCER)&&setTimeout(function(){e.media.cid===API.getMedia().cid&&u.stuckSkip&&(API.sendChat(a.userchat.songStuck),API.moderateForceSkip())},1e3*e.media.duration+5e3),setTimeout(function(){u.skipNextMediaInHistory&&0===API.getWaitListPosition()&&API.getNextMedia().inHistory&&!floodAPI&&$.ajax({url:"/_/playlists/"+API.getActivePlaylist().id+"/media/move",type:"PUT",data:JSON.stringify({beforeID:-1,ids:[API.getNextMedia().media.id]}),success:function(){pi._tool.log(a.info.nextMediaSkip,"info chat")},error:function(){pi._tool.log(a.warn.nextMediaInHistory,"warn chat")},dataType:"json",contentType:"application/json"})},1e4),sessionStorage.setItem("modSkipWarn","false"),sessionStorage.setItem("modQuitWarn","false"))},chat:function(e){if("log"!==e.type){var t='#chat [data-cid="'+e.cid+'"]',o=API.getUser(e.uid);if($(t).length&&(e.uid==API.getUser().id&&API.hasPermission(null,API.ROLE.BOUNCER)&&($(t)[0].className+=" deletable",$(t).prepend('<div class="delete-button" style="display: none;">'+a.glossary.delete+"</div>"),$(t).on("mouseenter",function(){$(t).find(".delete-button").length&&($(t).find(".delete-button")[0].style.display="block")}),$(t).on("mouseleave",function(){$(t).find(".delete-button").length&&($(t).find(".delete-button")[0].style.display="none")}),$(t).find(".delete-button").on("click",function(){API.moderateDeleteChat(e.cid)})),u.confirmDelete&&($(t+" .delete-button").off("click"),$(t+" .delete-button").on("click",function(t){if(t.preventDefault(),t.shiftKey)return API.moderateDeleteChat(e.cid);pi._tool.modal(!0,"confirmDelete",function(){API.moderateDeleteChat(e.cid)},e)}))),-1!==["Dev","Community Manager"].indexOf(pi._tool.getRank(o.id)))switch(e.message){case"!strobe on":if(!$("#pi-strobe").length){var i=$('<style id="pi-strobe">@keyframes strobe{0%{-webkit-filter:brightness(200%);filter:brightness(200%)}10%{-webkit-filter:brightness(10%);filter:brightness(10%)}}@keyframes strobe2{0%{box-shadow:0 20px 200px #fff}10%{box-shadow:none}}#avatars-container,#dj-button,#vote,.room-background,#pi-background{-webkit-filter:brightness(10%);filter:brightness(10%)}#avatars-container{animation:strobe .45s linear infinite}#playback-container{box-shadow:none!important;animation:strobe2 .45s linear infinite}</style>');$("head").append(i),pi._tool.log(pi._tool.replaceString(a.log.strobeOn,{user:o.username}),"chat")}break;case"!strobe off":$("#pi-strobe").length&&($("#pi-strobe")[0].remove(),pi._tool.log(pi._tool.replaceString(a.log.strobeOff,{user:o.username}),"chat"));break;case"!rainbow on":if(!$("#pi-rainbow").length){var s=$('<style id="pi-rainbow">@keyframes rainbow {from {-webkit-filter: saturate(200%) hue-rotate(0deg);filter: saturate(200%) hue-rotate(0deg);}to {-webkit-filter: saturate(200%) hue-rotate(360deg);filter: saturate(200%) hue-rotate(360deg);}}body {animation: rainbow 3s linear infinite;}</style>');$("head").append(s),pi._tool.log(pi._tool.replaceString(a.log.rainbowOn,{user:o.username}),"chat")}break;case"!rainbow off":$("#pi-rainbow").length&&($("#pi-rainbow")[0].remove(),pi._tool.log(pi._tool.replaceString(a.log.rainbowOff,{user:o.username}),"chat"))}var n="mention"===e.type&&API.hasPermission(e.uid,API.ROLE.BOUNCER),r=e.message.indexOf("@")<0&&(API.hasPermission(e.uid,API.ROLE.MANAGER)||-1!==["Dev","Community Manager"].indexOf(pi._tool.getRank(o.id)));(n||r)&&(e.message.indexOf("!joindisable")>-1&&u.autoDJ?(pi.menu("join"),API.sendChat("@"+e.un+" Auto-join disabled!")):e.message.indexOf("!afkdisable")>-1&&u.afk&&(pi.menu("afkResponder"),API.sendChat("@"+e.un+" AFK responder disabled!"))),(e.sound&&"mention"===e.sound||"mention"==e.type)&&e.uid!==API.getUser().id&&u.afk&&pi._tool.getRoomRules("allowAutorespond")&&((new Date).getTime()-m.afkResponder)/1e3/60>1?(u.afkMessage.length?API.sendChat("@"+e.un+" [AFK]: "+u.afkMessage):API.sendChat(pi._tool.replaceString(a.userchat.afkResponder,{mention:e.un})),m.afkResponder=(new Date).getTime()):(e.sound&&"mention"===e.sound||"mention"==e.type)&&u.systemNotifications&&!document.hasFocus()&&!u.afk?pi._tool.notify(pi._tool.replaceString(a.notifications.mentioned,{user:o.username}),$("<div>"+e.message+"</div>").text()+"\n\n"+a.notifications.reply,{onclick:function(){window.focus(),this.close()},onerror:function(e){console.log(e)}}):$("#chat-button").hasClass("selected")||"log"===e.type||($("#chat-button, "+t).each(function(){$(this).css("transition","all .5s"),$(this)[0].className+=" unread"}),$("#chat-button").one("click",function(){setTimeout(function(){$("#chat-button, "+t).removeClass("unread"),setTimeout(function(){$("#chat-button, "+t).css("transition","")},500)},3e3)})),"log"===e.type||document.hasFocus()||b.unread||(b.unread=!0,document.title="* "+API.getRoomName(),window.onfocus=function(){document.title=API.getRoomName(),b.unread=!1,window.onfocus=void 0}),b.chat.push(e)}},chatCommand:function(e){if(u.chatCommands){var t=e.split(" ");e=t.shift().slice(1);var o=t.join(" ");switch(e){case"r":var i=$(".cm.mention:last");if(0!==i.length){var s=API.getUser(i[0].getAttribute("data-cid").split("-")[0]);API.sendChat("@"+s.username+" "+o)}else pi._tool.log(a.error.noLastMention,"chat error"),$("#chat-input-field")[0].value=o;break;case"like":API.sendChat("😍💗😍💗😍");break;case"love":o.length?API.sendChat(o+" 😍💗😍💗😍💗😍💗😍💗"):API.sendChat("😍💗😍💗😍💗😍💗😍💗");break;case"lovespam":var n=1,r=setInterval(function(){n>5?clearInterval(r):n%2==0?API.sendChat("😍💗😍💗😍"):API.sendChat("💗😍💗😍💗"),n++},500);break;case"door":o.length?API.sendChat(o+" 🚪"):API.sendChat("🚪");break;case"doorrun":o.length?API.sendChat(o+" 🚪 🏃"):API.sendChat("🚪 🏃");break;case"fire":API.sendChat("🔥🔥🔥🔥🔥🔥🔥🔥🔥🔥");break;case"kong":API.sendChat(":kong::kong::kong::kong::kong::kong::kong:");break;case"shrug":o.length?API.sendChat(o+" ¯\\_(ツ)_/¯"):API.sendChat("¯\\_(ツ)_/¯");break;case"friend":if(!t[0])return pi._tool.log(a.info.helpUserOrId,"info chat");isNaN(t[0])&&(t[0]=API.getUserByName(t[0].replace(/@| $/g,"")).id),API.addFriendByID(Number(t[0]));break;case"gift":t[0]?(t[1]=isNaN(t[1])?25:t[1],isNaN(t[0])?(t[0]=API.getUserByName(t[0].replace(/@| $/g,"")).id,API.gift(t[0],t[1])):API.gift(t[0],t[1])):API.gift(4613422,1337,"a misterious person");break;case"pm":if(!t[0])return pi._tool.log(a.info.helpUserOrId,"info chat");if(isNaN(t[0])){if("object"!=typeof(f=API.getUserByName(t[0].replace(/@| $/g,""))))return pi._tool.log(a.error.userNotFound,"error chat");f=f.id}var l="";o.slice(t[0].length+1).split("").forEach(function(e,t,o){l+=e.charCodeAt(0)<=99?"0"+e.charCodeAt(0):e.charCodeAt(0)}),API.moderateDeleteChat(f+"-"+l);break;case"eta":pi.eta(!0);break;case"exportchat":var p="",d="csv"===t[0];b.chat.forEach(function(e,t,o){p+=d?e.type+","+e.uid+","+e.un+","+e.message+","+e.timestamp:"["+e.type+"] ["+e.uid+"] ["+e.un+"]\n"+e.message+" ["+e.timestamp+"]\n"}),$("<a></a>").attr("id","pi-exportchat").attr("href","data:text/"+(d?"csv":"text")+";charset=utf8,"+encodeURIComponent(p)).attr("download",API.getRoomName()+"-logs."+(d?"csv":"txt"))[0].click();break;case"vol":t[0]>=0&&t[0]<=100?(API.setVolume(t[0]),pi._tool.setPlugSettings("volume",t[0])):pi._tool.log(a.info.helpVol,"info chat");break;case"afk":0===o.length?o=void 0:pi.dom.afkMessage.children[0].value=u.afkMessage=o,$("#chat-input-field").one("blur",function(){pi.menu("afkResponder")});break;case"bot":if(!t[0])return pi._tool.log(a.info.helpUserOrId,"info chat");if(isNaN(t[0])){if("object"!=typeof(g=API.getUserByName(o.replace(/@| $/g,""))))return pi._tool.log(a.error.userNotFound,"error chat");g=g.id}-1!==u.bot.indexOf(g)?(u.bot.splice(u.bot.indexOf(g),1),pi._tool.log(pi._tool.replaceString(a.success.removedBot,{bot:API.getUser(g).username}),"success chat")):(u.bot.push(g),pi._tool.log(pi._tool.replaceString(a.success.addedBot,{bot:API.getUser(g).username}),"success chat"));break;case"discordbot":if(!t[0])return pi._tool.log(a.info.helpUserOrId,"info chat");var g;if(isNaN(t[0])){if("object"!=typeof(g=API.getUserByName(o.replace(/@| $/g,""))))return pi._tool.log(a.error.userNotFound,"error chat");g=g.id}-1!==u.discordbot.indexOf(g)?(u.discordbot.splice(u.discordbot.indexOf(g),1),pi._tool.log(pi._tool.replaceString(a.success.removedDiscordBot,{bot:API.getUser(g).username}),"success chat")):(u.discordbot.push(g),pi._tool.log(pi._tool.replaceString(a.success.addedDiscordBot,{bot:API.getUser(g).username}),"success chat"));break;case"kick":if((v=API.getUser()).role<API.ROLE.BOUNCER||v.role<API.ROLE.BOUNCER&&v.gRole===API.ROLE.NONE)return pi._tool.log(a.error.noSufficentPermissions,"error chat");var m=t.length>1&&!isNaN(t[t.length-1])?t.pop():5,f=t.join(" ");if(isNaN(f)){if("Object"!=typeof(f=API.getUserByName(f.replace(/@| $/g,""))))return pi.tool.log(a.error.userNotFound,"error chat");f=f.id}else f=API.getUser(f);if(f.id===v.id)return pi._tool.log(a.error.selfKick,"error chat");if(v.role<=f.role)return pi._tool.log(a.error.staffKick,"error chat");API.sendChat(pi._tool.replaceString(a.userchat.kicking,{user:f.username,time:m})),setTimeout(function(){API.moderateKickUser(f.id,m)},3e3);break;case"ban":if((v=API.getUser()).role<API.ROLE.BOUNCER||v.role<API.ROLE.BOUCNER&&v.gRole===API.ROLE.NONE)return pi._tool.log(a.error.noSufficentPermissions,"error chat");if(t.length>1){var h=t[t.length-1].toLowerCase();k="forever"===h||"day"===h||"hour"===h?t.pop():API.BAN.PERMA}f=t.join(" ");if(null===(f=isNaN(f)?API.getUserByName(f.replace(/@| $/g,"")):API.getUser(f)))return pi._tool.log(a.error.userNotFound,"error chat");if(f.id===v.id)return pi._tool.log(a.error.selfBan,"error chat");if(v.role<=f.role)return pi._tool.log(a.error.staffBan,"error chat");"forever"===(k=k.toLowerCase())?k=API.BAN.PERMA:"day"===k?k=API.BAN.DAY:"hour"===k&&(k=API.BAN.HOUR),API.moderateBanUser(f.id,1,k);break;case"mute":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");var v=API.getUser();if(v.role<API.ROLE.BOUNCER||v.role<API.ROLE.BOUNCER&&v.gRole===API.ROLE.NONE)return pi._tool.log(a.error.noSufficentPermissions,"error chat");var k;if(t.length>1){var y=t[t.length-1].toLowerCase();k="long"===y||"medium"===y||"short"===y?t.pop():API.MUTE.LONG}f=t.join(" ");if(null===(f=isNaN(f)?API.getUserByName(f.replace(/@| $/g,"")):API.getUser(f)))return pi._tool.log(a.error.userNotFound,"error chat");if(f.id===v.id)return pi._tool.log(a.error.selfMute,"error chat");if(v.role<=f.role)return pi._tool.log(a.error.staffMute,"error chat");"long"===(k=k.toLowerCase())?k=API.MUTE.LONG:"medium"===k?k=API.MUTE.MEDIUM:"short"===k&&(k=API.MUTE.SHORT),$.ajax({url:"/_/mutes",method:"POST",data:JSON.stringify({userID:f.id,reason:1,duration:k}),dataType:"json",contentType:"application/json"});break;case"host":case"cohost":case"manager":case"bouncer":case"residentdj":case"rdj":case"unrank":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");var I;if(void 0===o)return pi._tool.log(a.info.helpUserOrId,"info");I=isNaN(o)?API.getUserByName(o.replace(/@| $/g,"")).id:t[0];var P=-1;switch(e){case"host":P=API.ROLE.HOST;break;case"cohost":P=API.ROLE.COHOST;break;case"manager":P=API.ROLE.MANAGER;break;case"bouncer":P=API.ROLE.BOUNCER;break;case"residentdj":case"rdj":P=API.ROLE.DJ;break;case"unrank":P=API.ROLE.NONE}$.ajax({url:"unrank"===e?"/_/staff/"+I:"/_/staff/update",type:"unrank"===e?"DELETE":"POST",data:"unrank"===e?"":JSON.stringify({userID:I,roleID:P}),error:function(e){pi._tool.log(a.error.cannotRank,"error chat"),console.error(a.error.cannotRank,e)},dataType:"json",contentType:"application/json"});break;case"grabed?":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");if(API.getUser().id===API.getDJ().id){pi._tool.log(a.info.youPlay,"info chat");break}var A=API.getMedia(),_=!1,w=pi._tool.log(a.info.checkingPlaylists,"info chat");pi._tool.getPlaylists(function(e){e.forEach(function(e,t,o){setTimeout(function(){pi._tool.getPlaylist(e.id,function(i){_||w.edit(pi._tool.replaceString(a.info.checkingState,{current:t+1,total:o.length,name:e.name})),i.forEach(function(i,s,n){i.cid===A.cid&&(w.edit(pi._tool.replaceString(a.info.isGrabed,{name:e.name})),_=!0),t+1>=o.length&&s+1>=n.length&&!_&&w.edit(a.success.notGrabed).changeType("success")})})},c*t)})});break;case"duplicates":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");var S=o.match(/(\s?(\\,)?[^,])+/g),x=!1,N=!1,L=[],C=[],w=pi._tool.log(a.info.checkingDuplicates,"info chat");pi._tool.getPlaylists(function(e){e.forEach(function(e,t,o){if(x=!1,null!==S)for(var i=0;i<S.length;i++)e.name===S[i]&&(x=!0);x||setTimeout(function(){w.edit(pi._tool.replaceString(a.info.checkingState,{current:t+1,total:o.length,name:e.name})),pi._tool.getPlaylist(e.id,function(i){i.forEach(function(i,s,n){for(var r=0;r<L.length;r++)i.cid==L[r].cid?(pi._tool.log(pi._tool.replaceString(a.warn.duplicates,{author:i.author,title:i.title,name1:e.name,name2:C[r].name}),"warn chat"),N=!0):i.author===L[r].author&&i.title===L[r].title&&(pi._tool.log(pi._tool.replaceString(a.warn.possibleDuplicate,{author:i.author,title:i.title,name1:e.name,name2:C[r].name}),"warn chat"),N=!0);L.push(i),C.push(e),t+1!==o.length||s+1!==n.length||N?t+1===o.length&&s+1===n.length&&w.edit(a.success.duplicateFinished).changeType("success"):w.edit(a.success.noDuplicates).changeType("success")})})},c*t)})});break;case"removeLabels":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");if("false"===sessionStorage.getItem("removeLabelWarn"))return void pi._tool.log(a.warn.unlistedCommand,"warn chat",function(){this.delete(),sessionStorage.setItem("removeLabelWarn",!0),API.sendChat("/removeLabels")});w=pi._tool.log(a.info.checkingPlaylists,"info chat");pi._tool.getPlaylists(function(e){var t=/(([*【\[\(])?(trap|(melbourne ?)bounce|(happy ?)hardcore|progressive|future bass|glitchhop|glitch hop|glitch hop (\/|or)? 110bpm|indie dance|indie dance \/ nu disco|nu disco|(melodic)? ?dubstep|drumstep|drum and bass|drum&bass|dnb|edm|hard dance|electronic|(bass ?)house|progressive house|electro( ?swing)?|electro[ -]house|tropical house|deep house|house music|big room|chill|chillout|chillstep(free ?|full)?download|((monstercat ?)?official ?)?((music|lyric)( )?)video|(hq ?)?free|(tasty|monstercat|ncs)( ?(ep|lp|vip|free ?(ep|dl|download)) ?)?( ?release|download)?)([\)\]】*]|( ?\|\| ?))( ?- ?)?)/gi,o=[];e.forEach(function(e,i,s){setTimeout(function(){w.edit(pi._tool.replaceString(a.info.checkingStateRename,{current:i+1,total:s.length,name:e.name,found:o.length})),pi._tool.getPlaylist(e.id,function(n){n.forEach(function(n,r,l){(t.test(n.author)||t.test(n.title))&&o.push({playlist:e,song:n}),i+1>=s.length&&r+1>=l.length&&(w.edit(a.log.checkingRemoving).changeType("log"),o.length>0?o.forEach(function(e,o,i){setTimeout(function(){var s=e.song.author.replace(t,"").trim(),n=e.song.title.replace(t,"").trim();0===s.length&&(s=n.split("-")[0].trim(),n=n.substr(s.length).replace(/ ?- ?/i,"")),$.ajax({type:"PUT",url:"/_/playlists/"+e.playlist.id+"/media/update",data:JSON.stringify({id:e.song.id,author:s,title:n}),success:function(){pi._tool.log(pi._tool.replaceString(a.log.labelChanged,{author:e.song.author,title:e.song.title,newAuthor:s,newTitle:n}),"chat"),o+1>=i.length&&w.edit(pi._tool.replaceString(a.success.doneRenaming,{total:i.length,song:i.length>1?a.glossary.songs:a.glossary.song})).changeType("success")},error:function(e){pi._tool.log([a.error.renaming,e],"error")},dataType:"json",contentType:"application/json"})},c*o)}):w.edit(a.success.noRenaming).changeType("success"))})})},c*i)})});break;case"findBrokenSongs":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");var O=[],R={logToChat:!0,logToFile:!1,moveToTop:!0,moveToBottom:!1,remove:!1};confirm(a.modal.BrokenSongsChangeSettings)&&(R={logToConsole:confirm(a.modal.consoleLog),logToChat:confirm(a.modal.chatLog),logToFile:confirm(a.modal.fileLog),moveToTop:confirm(a.modal.moveTop),moveToBottom:confirm(a.modal.moveBottom),remove:confirm(a.modal.deleteSongs)}),R.logToChat&&(w=pi._tool.log(a.info.checkingUnavailable,"chat info")),pi._tool.getPlaylists(function(e){e.forEach(function(e,t,o){setTimeout(function(){R.logToChat&&w.edit(pi._tool.replaceString(a.info.checkingStateRename,{current:t+1,total:o.length,name:e.name,found:O.length})),pi._tool.getPlaylist(e.id,function(t){t.forEach(function(t,o,i){$.get("https://www.googleapis.com/youtube/v3/videos?id="+t.cid+"&key=AIzaSyC8pk0f57a_UcAIbHdrvRhsmHSG1KZk2SM&part=snippet,status",function(o){var i=!0;1==t.format&&0===o.items.length?(R.logToChat&&pi._tool.log(pi._tool.replaceString(a.error.brokenSong,{name:e.name,source:"YT",author:t.author,title:t.title,cid:t.cid}),"chat error"),i=!1):2==t.format?SC.get("/tracks/"+t.cid,function(o){void 0===o.title&&(pi._tool.log(pi._tool.replaceString(a.error.brokenSong,{name:e.name,source:"SC",author:t.author,title:t.title,cid:t.cid}),"chat error"),i=!1)}):1==o.items.length&&"processed"!=o.items[0].status.uploadStatus&&(pi._tool.log(pi._tool.replaceString(a.error.brokenSong,{name:e.name,source:"YT",author:t.author,title:t.title,cid:t.cid}),"chat error"),i=!1),i||(void 0===O[e.id]&&(O[e.id]=[]),O[e.id].push(t.id))})})})},c*t),t+1>=o.length&&setTimeout(function(){Object.keys(O).forEach(function(e,t,o){setTimeout(function(){R.moveToTop||R.moveToBottom?(R.logToChat&&w.edit(pi._tool.replaceString(a.info.moveMedia,{current:t+1,total:o.length,direction:R.moveToTop?a.glossary.top:a.glossary.bottom})),$.ajax({type:"PUT",url:"/_/playlists/"+e+"/media/move",data:'{"ids":'+JSON.stringify(O[e])+',"beforeID":'+(R.moveToTop?"0":"-1")+"}",dataType:"json",contentType:"application/json"})):R.remove&&(R.logToChat&&w.edit(pi._tool.replaceString(a.info.removeMedia,{current:t+1,total:o.length})),$.ajax({type:"POST",url:"/_/playlists/"+e+"/media/delete",data:'{"ids":'+JSON.stringify(O[e])+"}",dataType:"json",contentType:"application/json"})),t+1>=o.length&&(R.logToChat&&w.edit(a.success.unavailableFinished).changeType("success"),setTimeout(function(){R.logToFile&&download("","plug.dj unavailable songs.txt","text/plain")},o.length*c+2e3))},t*c)}),0===Object.keys(O).length&&R.logToChat&&w.edit(a.success.noUnavailable).changeType("success")},o.length*c)})});break;case"whoami":var T=API.getUser(),D=pi._tool.getRank(T.id).length?pi._tool.getRank(T.id)[0]:a.glossary.none;pi._tool.log(pi._tool.replaceString(a.info.whoami,{username:T.username,rawun:T.rawun,id:T.id,blurb:T.blurb,language:T.language,profile:T.level>=5?'\n<a target="_blank" href="/@/'+T.username.toLowerCase().replace(/([^A-z]\s)|(\s[^A-z])/g,"").replace(" ","-").replace(/[^A-z-0-9]|\[|\]/g,"")+'">Profile</a>':"",avatar:T.avatarID,badge:T.badge,lvl:T.level,xp:T.xp,pp:T.pp,joined:new Date(T.joined).toUTCString(),vote:T.vote,grab:T.grab,plugRole:T.gRole,plugitRole:D,rank:T.role,guest:T.guest,sub:T.sub,silver:T.silver}),"info chat");break;case"whois":if(void 0===t[0])return pi._tool.log(a.info.helpUserOrId,"info");isNaN(o)?((o=o.replace("@","")).lastIndexOf(" ")===o.length-1&&(o=o.slice(0,-1)),f=API.getUserByName(o),"object"!=typeof API.getUserByName(o)&&pi.tool.log(a.error.userNotFound,"error chat")):f=API.getUser(o);D=pi._tool.getRank(f.id).length?pi._tool.getRank(f.id)[0]:a.glossary.none;null!==f&&Object.keys(f).length>0?pi._tool.log(pi._tool.replaceString(a.info.whois,{username:f.username,rawun:f.rawun,id:f.id,language:f.language,profile:void 0!==f.slug?'\n<a target="_blank" href="/@/'+f.slug+'">Profile</a>':"",avatar:f.avatarID,badge:f.badge,lvl:f.level,joined:new Date(f.joined).toUTCString(),vote:f.vote,grab:f.grab,plugRole:f.gRole,plugitRole:D,rank:f.role,guest:f.guest,sub:f.sub,silver:f.silver,friend:f.friend}),"info chat"):pi._tool.log(a.error.userNotFound,"error chat");break;case"pi":API.sendChat("Get Plug-It : https://plug-it.github.io");break;case"js":execute(o,void 0,a.warn.isTrusted);break;case"list":pi._tool.log("/r (message)\n/like (@user/message)\n/love (@user/message)\n/lovespam\n/door (@user/message)\n/doorrun (@user/message)\n/fire\n/kong\n/shrug (message)\n/friend [@user/id]\n/gift [@user/id] [amount]\n/eta\n/exportchat (csv)\n/vol [0-100]\n/afk [message]\n/bot [@user/id]\n/discordbot [@user/id]\n/kick [@user/id] (seconds)\n/ban [@user/id] [forever/day/hour]\n/host|cohost|manager|bouncer|residentdj|rdj|unrank [@user/id]\n/grabed?\n/duplicates (Excluded playlist(s),playlist\\,with\\,coma)\n/findBrokenSongs\n/whoami\n/whois [id/pseudo]\n/pi\n/js [javaScript code]\n/reload\n/kill\n/list","chat");break;case"reload":pi._reload();break;case"kill":pi._close();break;default:"false"===sessionStorage.getItem("helpCommands")&&(pi._tool.log(a.log.help,"info chat"),sessionStorage.setItem("helpCommands",!0))}}},earn:function(e){if(u.gainNotification){var t,o=API.getUser().xp+e.xp,i=API.getUser().pp+e.pp,s=e.xp>=u.minimumGain.xp,n=e.pp>=u.minimumGain.pp;o=o>999?o.spaceOut():o,i=i>999?i.spaceOut():i,e.pp=e.pp>999?e.pp.spaceOut():e.pp,e.xp=e.xp>999?e.xp.spaceOut():e.xp,0===e.pp&&s?t=e.xp+" xp.\nTotal: "+o+" xp":0===e.xp&&n?t=e.pp+" PP.\nTotal: "+i+" PP":s&&n?t=e.xp+" xp and "+e.pp+" PP.\nTotal: "+o+" xp\n"+i+" PP":s?t=e.xp+" xp.\nTotal: "+o+" xp":n&&(t=e.pp+" PP.\nTotal: "+i+" PP"),void 0!==t&&pi._tool.log(pi._tool.replaceString(a.log.earn,{gain:t}),"chat")}},friendJoin:function(e){},grabUpdate:function(e){pi.voteAlert(e)},guestJoin:function(e){pi._tool.log(pi._tool.replaceString(a.log.guestJoin,{guests:e}),"chat")},guestLeave:function(e){pi._tool.log(pi._tool.replaceString(a.log.guestLeave,{guests:e}),"chat")},historyUpdate:function(e){if(u.historyAlert){var t=API.getMedia(),o=API.getDJ(),i=null;if(void 0===t)return;API.hasPermission(null,API.ROLE.BOUNCER)&&(i=function(e,t){e.cid===API.getMedia().cid?(API.sendChat(pi._tool.replaceString(a.djSkip,{dj:t.username})),API.moderateForceSkip(),this.delete()):this.edit(a.error.cannotSkipFinished).changeType("error").removeCallback()});for(var s=1;s<e.length;s++)if(t.format==e[s].media.format&&t.cid==e[s].media.cid)pi._tool.log(pi._tool.replaceString(a.warn.djInHistory,{dj:o.username,author:e[s].media.author,title:e[s].media.title,historydj:e[s].user.username,turns:s-1,skip:API.hasPermission(null,API.ROLE.BOUNCER)?"\nClick here to force skip.":null}),"warn chat",i,t,o)}},modSkip:function(e){},scoreUpdate:function(e){b.woots=API.getUsers().filter(function(e){return 1==e.vote}),b.grabs=API.getUsers().filter(function(e){return e.grab}),b.mehs=API.getUsers().filter(function(e){return-1==e.vote})},userJoin:function(e){if(u.userJoin){var t=u.userInfo?" Lvl:"+e.level+"|Id:"+e.id:"";pi._tool.log(pi._tool.replaceString(a.log.userJoin,{user:e.username,userInfo:t}),"chat")}},userLeave:function(e){if(u.userLeave){var t=u.userInfo?" Lvl:"+e.level+"|Id:"+e.id:"";pi._tool.log(pi._tool.replaceString(a.log.userLeave,{user:e.username,userInfo:t}),"chat")}},userSkip:function(e){},voteUpdate:function(e){pi.voteAlert(e)},waitListUpdate:function(e){u.boothAlert&&API.getWaitListPosition()+1===u.boothPosition&&(pi._tool.log(pi._tool.replaceString(a.warn.boothAlert,{pos:u.boothPosition}),"warn chat"),!document.hasFocus()&&pi._tool.getPlugSettings().chatSound&&new Audio(d.sounds.notification).play())}},_modulesEvent:{chatReceive:function(e){if(-1===["moderation","system","promo","user-action","log","welcome"].indexOf(e.type)&&-1===e.cid.indexOf("rcs")){var t='#chat [data-cid="'+e.cid+'"]',o=API.getUser(e.uid);if($(t).length){switch(pi._tool.getRank(o.id).forEach(function(e){switch(e){case"Dev":$(t)[0].className+=" pi-dev",$(t+" .un").before($('<i class="icon icon-pi-dev" title="Plug-It Developer"></i>'));break;case"Helper":$(t)[0].className+=" pi-helper",$(t+" .un").before($('<i class="icon icon-pi-helper" title="Plug-It Helper"></i>'));break;case"Graphist":$(t)[0].className+=" pi-graphist",$(t+" .un").before($('<i class="icon icon-pi-graphist" title="Plug-It Graphist"></i>'));break;case"Translator":$(t)[0].className+=" pi-translator",$(t+" .un").before($('<i class="icon icon-pi-translator" title="Plug-It Translator"></i>'));break;case"Community Manager":$(t)[0].className+=" pi-community-manager",$(t+" .un").before($('<i class="icon icon-pi-community-manager" title="Plug-It Community Manager"></i>'));break;case"Donator":$(t)[0].className+=" pi-donator";break;case"Alpha":$(t)[0].className+=" pi-alpha",$(t+" .un").before($('<i class="icon icon-pi-alpha" title="Plug-It Alpha tester"></i>'));break;case"Bot":$(t)[0].className+=" pi-bot",$(t+" .un").before($('<i class="icon icon-pi-bot" title="Plug-It Bot"></i>'));break;case"Discord Bot":$(t)[0].className+=" pi-discord-bot",$(t+" .un").before($('<i class="icon icon-pi-discord-bot" title="Plug-It Discord Bot"></i>'))}}),o.gRole){case API.GLOBAL_ROLE.ADMIN:$(t)[0].className+=" role-admin";break;case API.GLOBAL_ROLE.AMBASSADOR:$(t)[0].className+=" role-ambassador";break;case API.GLOBAL_ROLE.MODERATOR:$(t)[0].className+=" role-sitemod";break;case API.GLOBAL_ROLE.PLOT:$(t)[0].className+=" role-plot";break;case API.GLOBAL_ROLE.PROMOTER:$(t)[0].className+=" role-promoter"}switch(o.role){case API.ROLE.HOST:$(t)[0].className+=" role-host";break;case API.ROLE.COHOST:$(t)[0].className+=" role-cohost",$(t+" .icon-chat-host")[0].className="icon icon-chat-cohost";break;case API.ROLE.MANAGER:$(t)[0].className+=" role-manager";break;case API.ROLE.BOUNCER:$(t)[0].className+=" role-bouncer";break;case API.ROLE.DJ:$(t)[0].className+=" role-dj"}if(1==o.sub&&($(t)[0].className+=" role-subscriber"),o.silver&&($(t)[0].className+=" role-silver-subscriber"),o.friend&&($(t)[0].className+=" role-friend"),u.friendsIcons&&o.friend&&$(t+" .timestamp").before($(emoji.replace_colons(":busts_in_silhouette:")).attr({class:"emoji-outer emoji-sizer pi-friendsIcons",style:"margin-left: 2px;",title:"You are friends with this user"})),u.languageFlags){var i;switch(o.language){case"cs":i=":flag-cz:";break;case"da":i=":flag-dk:";break;case"en":i=":flag-gb:";break;case"ja":i=":flag-jp:";break;case"ko":i=":flag-kr:";break;case"pi":i=":skull_and_crossbones:";break;case"uk":i=":flag-ua:";break;case"zh":i=":flag-cn:";break;case null:i=":heavy_multiplication_x:";break;default:i=":flag-"+o.language+":"}i=$(emoji.replace_colons(i)).attr({class:"emoji-outer emoji-sizer pi-languageFlags",style:u.friendsIcons&&o.friend?"":"margin-left: 2px;",title:h.Lang.languages[null!==o.language?o.language:"no language set"]}),$(t+" .timestamp").before(i)}u.userInfo&&$(t+" .timestamp").before('<span class="userInfo"><strong>LVL: </strong>'+o.level+"<strong> | ID: </strong>"+o.id+"</span>"),pi.betterClearChat(u.chatLimit)}if(-1!==pi._tool.getRank(o.id).indexOf("Discord Bot"))if(e.message=e.message.replace(/^(\[[^\]]*\])/,'<span class="discord-username">$1</span>'),$(t).length)$(t).find(".text")[0].innerHTML=e.message;else{var a=$("#chat .cm.pi-discord-bot:last .text")[0].innerHTML.split("<br>");a.pop(),a.push(e.message),$("#chat .cm.pi-discord-bot:last .text")[0].innerHTML=a.join("<br>")}var s=new RegExp(":([a-z0-9-_]+):","ig");if(pi._tool.getPlugSettings().emoji&&s.test(e.message)){var n=s.exec(e.message);for(n=s.exec(e.message);null!==n;){for(var r in g.emotes)n[1]==r&&(e.message=e.message.replace(":"+r+":",'<img style="max-width:100%;" src="'+g.emotes[r]+'" alt="'+r+'"/>'));for(var r in f)n[1]==r&&(e.message=e.message.replace(":"+r+":",'<img style="max-width:100%;" src="'+g.emotes[r]+'" alt="'+r+'"/>'));n=s.exec(e.message)}texts=$(".text.cid-"+e.cid)[0].innerHTML.split("<br>"),texts[texts.length-1]=e.message,$(".text.cid-"+e.cid)[0].innerHTML=texts.join("<br>")}u.gRoleCmdSelfDel&&API.getUser().gRole>API.ROLE.NONE&&API.getUser().id===e.uid&&0===e.message.indexOf("!")&&API.moderateDeleteChat(e.cid)}},chatDelete:function(e){if("object"==typeof e){if(0===$(".cid-"+e.p.c).length){var t=e.p.c.split("-");if(t[0]==API.getUser().id&&13!==t[1].length){var o="";t[1].match(/.{1,3}/g).forEach(function(e,t,i){o+=String.fromCharCode(parseInt(e))}),pi._tool.log("New PM from ["+API.getUser(e.p.mi).username+"]\n"+o)}}if(u.showDeletedMsg){var i=$(".cid-"+e.p.c).closest(".cm"),s=h.utils.getSimpleTimestamp(),n=API.getUser(e.p.c.split("-")[0]),r=API.getUser(e.p.mi),l=i.find('.pi-deleted[data-id="'+e.p.mi+'"]');if((r.gRole===API.ROLE.HOST||n.gRole>API.ROLE.NONE&&n.id===r.id||n.gRole!==API.ROLE.HOST||n.gRole!==API.ROLE.MANAGER)&&i.addClass("deleted"),i.find(".delete-button").remove(),l.length>0){var c=parseInt(l.attr("data-count"))+1;l.attr("data-count",c),l.html(pi._tool.replaceString(a.userchat.chatDelete,{mod:r.username,newCount:"(x"+c+")",time:s}))}else i.find(".msg").after($('<span class="pi-deleted" data-id="'+e.p.mi+'" data-count="1">'+pi._tool.replaceString(a.userchat.chatDelete,{mod:r.username,newCount:"",time:s})+"</span>"));pi._tool.log("This is to fix deleted messages","chat").delete()}else;}},streamDisabled:function(){var e=h.plugOptions.settings.streamDisabled;$("#pi-toggleStream .pi-toggleStream")[0].className=e?"icon pi-toggleStream off":"icon pi-toggleStream"}},_DOMEvent:{chatAutocompletion:function(e){$(this).data("lastval")!==this.value&&$(this).data("lastval",this.value)},collideRanks:function(){var e=setInterval(function(){$(".group").length&&($(".group").css("cursor","pointer"),$(".group").on("click",function(){$(this).nextUntil(".group").slideToggle()}),clearInterval(e))},10)},keyboardShortcuts:function(e){if(u.keyboardShortcuts)switch(e.key){case"+":$("#chat-input").hasClass("focused")||$(":focus").length||$(".dialog").length||(API.setVolume(API.getVolume()+5),pi._tool.setPlugSettings("volume",API.getVolume()));break;case"-":$("#chat-input").hasClass("focused")||$(":focus").length||$(".dialog").length||(API.setVolume(API.getVolume()-5),pi._tool.setPlugSettings("volume",API.getVolume()));break;case"h":$("#chat-input").hasClass("focused")||$(":focus").length||$(".dialog").length||pi.menu("video");break;case"l":e.ctrlKey&&(e.preventDefault(),pi.betterClearChat(u.betterClearChatLimit));break;case"b":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");if(e.ctrlKey){e.preventDefault();var t=API.getUserByName($("#user-rollover .username")[0].innerText);t&&API.hasPermission(null,API.ROLE.MANAGER)?sessionStorage.getItem("FastBan Warn")?$.ajax({type:"POST",url:"/_/bans/add",data:JSON.stringify({userID:t.id,reason:1,duration:"f"}),error:function(e){console.log(e)},dataType:"json",contentType:"application/json"}):pi._tool.log(a.warn.fastBan,"warn chat",function(){sessionStorage.setItem("FastBan Warn",!0),$.ajax({type:"POST",url:"/_/bans/add",data:JSON.stringify({userID:t.id,reason:1,duration:"f"}),error:function(e){console.log(e)},dataType:"json",contentType:"application/json"})}):pi._tool.log(a.info.fastBanHelp,"info chat")}break;case"w":case"m":if(!$("#chat-input").hasClass("focused")&&!$(":focus").length&&!$(".dialog").length){var o=(new Date).getTime();o-m.voteShortcut>=5e3&&0===$(":focus").length&&(m.voteShortcut=o,"w"===e.key?$("#woot").click():$("#meh").click())}break;case"g":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");$("#chat-input").hasClass("focused")||$(":focus").length||$(".dialog").length||API.getDJ().id===API.getUser().id||$.ajax({type:"GET",url:"/_/rooms/state",success:function(e){pi._tool.getPlaylists(function(t){$.ajax({type:"POST",url:"/_/grabs",data:JSON.stringify({playlistID:t.filter(function(e){return e.active})[0].id,historyID:e.data[0].playback.historyID}),error:function(e){"maxItems"===e.responseJSON.status?pi._tool.log(a.error.playlistFull,"error"):pi._tool.log([a.error.cannotGrab,e.responseText],"error")},dataType:"json",contentType:"application/json"})})},error:function(e){pi._tool.log(a.error.cannotGetMediaID,"error chat"),console.error(e)}});break;case"G":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");$("#chat-input").hasClass("focused")||$(":focus").length||$(".dialog").length||API.getDJ().id===API.getUser().id||pi._tool.getPlaylists(function(e){$.ajax({type:"POST",url:"/_/playlists/"+e.filter(function(e){return e.active})[0].id+"/media/insert",data:JSON.stringify({media:[API.getMedia()],append:!0}),error:function(e){"maxItems"===e.responseJSON.status?pi._tool.log(a.error.playlistFull,"error"):pi._tool.log([a.error.cannotGrab,e.responseText],"error")},dataType:"json",contentType:"application/json"})});break;case"ArrowRight":if(b.floodAPI)return pi._tool.log(a.error.APIFloodInEffect,"chat error");!e.ctrlKey||API.getDJ().id!==API.getUser().id||$("#chat-input").hasClass("focused")||$(":focus").length||$(".dialog").length||$.post("/_/booth/skip/me");break;case"Tab":$(".dialog").length||(e.preventDefault(),$("#chat-input-field").focus());break;case"Enter":$(".dialog-frame .button.submit").length&&$(".dialog-frame .button.submit").click();break;case"Escape":var i="#footer-user.showing .back,.app-header #history-button.selected,#app-menu.open .button,#playlist-button .icon-arrow-down,.dialog .icon-dialog-close";$(i).length?$(i).click():$("#chat-input-field").is(":focus")&&$("#chat-input-field").blur()}},levelPercentage:function(){setTimeout(function(){if(!("undefined"!=typeof rcs||$("#footer-user .bar .value").text().indexOf("%")>-1)){var e=$("#footer-user .bar .value")[0].innerText.match(/(\d*[,.]?\d*)(?: \/ )(\d*[,.]?\d*)/);if(null!==e){var t=(parseFloat(e[1].replace(/[,.]/g,""))/parseFloat(e[2].replace(/[,.]/g,""))*100).toFixed(2);$("#footer-user .bar .value")[0].innerText=e[0].replace(/,/g,".")+" ("+t+"%)",$("#footer-user .info .meta .bar .value").one("DOMSubtreeModified",pi._DOMEvent.levelPercentage)}}},100)},navWarn:function(e){var t=a.log.leaving;if(u.navWarn)return(e||window.event).returnValue=t,t},popout:function(){setTimeout(function(){window.popout=window.open("","plugdjpopout");var t=[$('<link id="pi-popout-menu" rel="stylesheet" type="text/css" href="'+d.styles.popout+'">')];u.roomStyle&&t.push($('<link id="pi-custom-room-style" rel="stylesheet" type="text/css" href="'+g.css+'">')),u.CSS&&t.push($('<link id="pi-popout-blue" rel="stylesheet" type="text/css" href="'+d.styles.popout_blue+'">')),u.customRanks&&t.push($('<link id="pi-custom_ranks" rel="stylesheet" type="text/css" href="'+d.styles.custom_ranks+'">')),u.oldChat&&t.push($('<link id="pi-oldchat-CSS" rel="stylesheet" type="text/css" href="'+d.styles.old_chat+'">')),$("head",popout.document).append(t),$("#volume",popout.document).on("mousewheel",pi._DOMEvent.volumeWheel),e(popout,"onbeforeunload",function(){popout=null})},2e3)},resize:function(){var e=Math.max(1150,window.innerWidth)-345,t=Math.max(638,window.innerHeight),o=t-54-800,i=Math.min(54,o);pi._tool.getPlugSettings().videoOnly?$("#pi-background").css("left",0).css("top",54).width(e).height(t-108):$("#pi-background").css("left",(e-1600)/2).css("top",i).width(1600).height(900)},volumeWheel:function(e){e.preventDefault();var t=e.ctrlKey?1:5;e.originalEvent.deltaY>0?API.setVolume(API.getVolume()-t):e.originalEvent.deltaY<0&&API.setVolume(API.getVolume()+t),pi._tool.setPlugSettings("volume",API.getVolume())},translate:function(e){e.target.classList.contains("translated")?(e.target.innerHTML=e.target.getAttribute("data-originalText"),e.target.removeAttribute("data-originalText"),e.target.classList.remove("translated")):e.target.classList.contains("text")&&$.ajax({type:"GET",url:"https://translate.googleapis.com/translate_a/single?client=gtx&dt=t&sl=auto&tl="+API.getUser().language+"&q="+encodeURI(e.target.innerHTML),error:function(t){var o=JSON.parse(t.responseText.split(",").filter(function(e){return e.length}).join(","))[0][0][0];e.target.setAttribute("data-originalText",e.target.innerHTML),e.target.innerHTML=o,e.target.classList.add("translated")},success:function(t){var o=t[0][0][0];e.target.setAttribute("data-originalText",e.target.innerHTML),e.target.innerHTML=o,e.target.classList.add("translated")}})}},_load:function(){t("Initalizating modules",3),$.each(require.s.contexts._.defined,function(e,t){t&&(t._moduleID=e,t._moduleID&&"lang/Lang"===t._moduleID&&(h.Lang=t),t._events&&t._events["chat:receive"]&&(h.context=t),t.STATE&&(h.RoomEvent=t),t.attributes&&t.attributes.hostID&&(h.room=t),t._l&&(h.user=t),t.log&&(h.chatFacade=t),t.defaultSettings&&(h.plugOptions=t),t.hasOwnProperty("isorx")&&(h.utils=t),t.SHOW&&"ShowDialogEvent:show"===t.SHOW&&(h.ShowDialogEvent=t),t.prototype&&t.prototype.id&&"dialog-gift-send"===t.prototype.id&&(h.GiftSendDialog=t),t.prototype&&t.prototype.defaults&&t.prototype.defaults._position&&(h.User=t))}),h.lang=require("lang/Lang"),t("Initalizating API & Events listener",4),pi._extendAPI.init();for(var e in pi._event)API.on(e,pi._event[e]);pi._tool.plugSocketHook.init(),h.context.on("chat:receive",pi._modulesEvent.chatReceive),h.originalChatDelete=h.context._events["chat:delete"][0].callback,h.context._events["chat:delete"][0].callback=pi._modulesEvent.chatDelete,h.context.on("change:streamDisabled",pi._modulesEvent.streamDisabled),window.onbeforeunload=pi._DOMEvent.navWarn,$(window).on("keydown",pi._DOMEvent.keyboardShortcuts),$(window).on("dblclick",pi._DOMEvent.translate),$("#volume, #playback-controls").on("mousewheel",pi._DOMEvent.volumeWheel),$(".button.staff").on("click",pi._DOMEvent.collideRanks),$("#chat-popout-button").on("click",pi._DOMEvent.popout),$("#chat-input-field").on("input",pi._DOMEvent.chatAutocompletion),$(document).on("ajaxSuccess",pi._DOMEvent.updateRoomSettings),pi._DOMEvent.levelPercentage(),t("Loading user settings",5);var o=localStorage.getItem("pi-settings");if("string"==typeof o){var i=JSON.parse(o);for(var s in u)void 0===i[s]&&(i[s]=u[s]);for(var n in i)void 0===u[n]&&delete i[n];localStorage.setItem("pi-settings",JSON.stringify(i)),u=i}else pi._tool.saveSettings();null===sessionStorage.getItem("modSkipWarn")&&(sessionStorage.setItem("modSkipWarn",!1),sessionStorage.setItem("modQuitWarn",!1),sessionStorage.setItem("trustWarn",!1),sessionStorage.setItem("fastBanWarn",!1),sessionStorage.setItem("helpCommands",!1),sessionStorage.setItem("removeLabelWarn",!1)),window.friendsOnline=setInterval(function(){pi._tool.getFriends(function(e){if(u.unfriended){var t=localStorage.getItem("pi-friends");null!==t&&(t=JSON.parse(t),e.length<t.length&&t.filter(function(t){for(var o=!1,i=0;i<e.length;i++)e[i].id===t.id&&(o=!0);return!o}).forEach(function(e){pi._tool.log(pi._tool.replaceString(a.info.unfriended,{friend:e.username,sad:emoji.replace_colons(":cry:")}),"info chat")})),localStorage.setItem("pi-friends",JSON.stringify(e))}for(var o=[],i=0;i<e.length;i++)void 0===e[i].status&&o.push(e[i]);var s=$("#friends-button > span")[0].innerText.replace(/[0-9]*\//g,"");if(s=o.length+"/"+s,$("#friends-button > span")[0].innerText=s,u.friendConnect||u.friendDisconnect||u.friendRoomChange){var n=sessionStorage.getItem("friendsOnline");if(null===n)sessionStorage.setItem("friendsOnline",JSON.stringify(o));else{n=JSON.parse(n);for(i=0;i<o.length;i++){for(var r=!1,l=0;l<n.length;l++)o[i].id==n[l].id&&(r=!0,o[i].room.id!==n[l].room.id&&u.friendRoomChange&&("dashboard"==o[i].room.slug?pi._tool.log(pi._tool.replaceString(a.log.friendRoomChangeDashboard,{friend:o[i].username}),"chat"):pi._tool.log(pi._tool.replaceString(a.log.friendRoomChange,{friend:o[i].username,link:o[i].room.slug,name:o[i].room.name}),"chat").div.find("a").on("click",{friend:o[i]},function(e){e.preventDefault();var t=e.data.friend.room.slug,o=e.data.friend.room.name;h.context.dispatch(new h.RoomEvent(h.RoomEvent.JOIN,t,o))})));!r&&u.friendConnect&&(void 0===o[i].room.name?pi._tool.log(pi._tool.replaceString(a.log.friendConnectDashboard,{friend:o[i].username}),"chat"):pi._tool.log(pi._tool.replaceString(a.log.friendConnect,{friend:o[i].username,link:o[i].room.slug,name:o[i].room.name}),"chat").div.find("a").on("click",{friend:o[i]},function(e){e.preventDefault();var t=e.data.friend.room.slug,o=e.data.friend.room.name;h.context.dispatch(new h.RoomEvent(h.RoomEvent.JOIN,t,o))}))}for(i=0;i<n.length;i++){for(var r=!1,l=0;l<o.length;l++)n[i].id==o[l].id&&(r=!0);!r&&u.friendDisconnect&&pi._tool.log(pi._tool.replaceString(a.log.friendDisconnect,{friend:n[i].username}),"chat")}sessionStorage.setItem("friendsOnline",JSON.stringify(o))}}})},3e4),window.roomURL=location.pathname,window.checkIfRoomChanged=setInterval(function(){location.pathname!==window.roomURL&&(window.roomURL=location.pathname,clearInterval(window.checkIfRoomChanged),pi._reload("roomChange"))},2e3),t("Creating script environement",6),$("#app").append($('<div id="pi-logo"><div id="icon"></div></div>')),$("#playback-container").append($('<iframe id="pi-frame" frameborder="0" src=""></iframe>').css({display:"none",position:"absolute",top:"0",left:"0","z-index":"5",width:"100%",height:"100%"})),$(".room-background").after($('<div id="pi-background"></div>').css({display:"none",position:"absolute",top:Math.min(54,Math.max(638,window.innerHeight)-54-800),left:(Math.max(1150,window.innerWidth)-345-1600)/2,width:"1600px",height:"900px",background:"url("+u.customBGURL+") no-repeat"})),$("#app").append($('<div id="pi-menu" style="display: none;"><ul><h2>'+a.menu.general.title+'</h2><ul style="display: none;"><li id="pi-woot">'+a.menu.general.autoWoot+'</li><li id="pi-join">'+a.menu.general.autoJoin+'</li><li id="pi-keyShortcut">'+a.menu.general.keyboardShortcuts+'</li><li id="pi-chatCommands">'+a.menu.general.chatCommands+'</li><li id="pi-autoHideLogs">'+a.menu.general.autoHideLogs+'</li><li id="pi-autoHideLogsAfter"><label for="autoHideLogsAfter">'+a.menu.general.autoHidelogsLabel+'</label><input type="number" min="1" max="3600" step="1" value="'+u.autoHideLogsAfter+'" name="autoHideLogsAfter"/></li><li id="pi-mutemeh">'+a.menu.general.muteMeh+'</li><li id="pi-afkResponder">'+a.menu.general.afkResponder+'</li><li id="pi-afkMessage"><input type="text" placeholder="'+a.menu.general.afkResponderPlaceholder+'"/></li><li id="pi-navWarn">'+a.menu.general.navigationWarn+'</li><li id="pi-showVotes">'+a.menu.general.showVotes+'</li><li id="pi-betterClearChatLimit"><label for="betterClearLimit">'+a.menu.general.clearChatLimitLabel+'</label><input type="number" min="0" max="512" step="1" value="'+u.betterClearChatLimit+'" name="betterClearLimit"/></li><li id="pi-chatLimit"><label for="chatLimit">'+a.menu.general.chatLimitLabel+'</label><input type="number" min="1" max="512" step="1" value="'+u.chatLimit+'" name="chatLimit"/></li><li id="pi-skipNextMediaInHistory">'+a.menu.general.skipNextMediaHistory+"</li></ul><h2>"+a.menu.customisation.title+'</h2><ul style="display: none;"><li id="pi-video">'+a.menu.customisation.hideVideo+'</li><li id="pi-soundcloudVisu">'+a.menu.customisation.scVisu+'</li><li id="pi-css">'+a.menu.customisation.customStyle+'</li><li id="pi-customRanks">'+a.menu.customisation.customRanks+'</li><li id="pi-languageFlags">'+a.menu.customisation.languageFlags+'</li><li id="pi-friendsIcons">'+a.menu.customisation.friendsIcons+'</li><li id="pi-bg">'+a.menu.customisation.customBG+'</li><li id="pi-old-chat">'+a.menu.customisation.oldChat+'</li><li id="pi-old-footer">'+a.menu.customisation.oldFooter+'</li><li id="pi-small-history">'+a.menu.customisation.smallHistory+'</li><li id="pi-small-friends">'+a.menu.customisation.smallFriends+'</li><li id="pi-small-playlists">'+a.menu.customisation.smallPlaylists+"</li></ul><h2>"+a.menu.moderation.title+'</h2><ul style="display: none;"><li id="pi-showDeletedMsg">'+a.menu.moderation.showDeletedMsg+'</li><li id="pi-confirmDelete">'+a.menu.moderation.confirmChatDeletion+'</li><li id="pi-userInfo">'+a.menu.moderation.userInformation+'</li><li id="pi-stuckSkip">'+a.menu.moderation.skipStuckSongs+'</li><li id="pi-lengthA">'+a.menu.moderation.songLimit+'</li><li id="pi-songLength"><input type="text" placeholder="'+a.menu.moderation.songLimitPlaceholder+'"/></li><li id="pi-historyA">'+a.menu.moderation.historyAlert+"</li></ul><h2>"+a.menu.notifications.title+'</h2><ul style="display: none;"><li id="pi-systemNotifications">'+a.menu.notifications.systemNotifications+'</li><li id="pi-songStats">'+a.menu.notifications.songStats+'</li><li id="pi-boothAlert">'+a.menu.notifications.boothAlert+'</li><li id="pi-boothPosition"><label for="boothPosition">'+a.menu.notifications.boothPositionLabel+'</label><input type="number" min="1" max="50" step="1" value="'+u.boothPosition+'" name="boothPosition"/></li><li id="pi-userJoin">'+a.menu.notifications.userJoin+'</li><li id="pi-userLeave">'+a.menu.notifications.userLeave+'</li><li id="pi-userWoot">'+a.menu.notifications.userWoot+'</li><li id="pi-userGrab">'+a.menu.notifications.userGrab+'</li><li id="pi-userMeh">'+a.menu.notifications.userMeh+'</li><li id="pi-guestJoin">'+a.menu.notifications.guestJoin+'</li><li id="pi-guestLeave">'+a.menu.notifications.guestLeave+'</li><li id="pi-friendRoomChange">'+a.menu.notifications.friendRoomChange+'</li><li id="pi-friendConnect">'+a.menu.notifications.friendConnect+'</li><li id="pi-friendDisconnect">'+a.menu.notifications.friendDisconnect+'</li><li id="pi-unfriended">'+a.menu.notifications.unfriended+'</li><li id="pi-gainNotification">'+a.menu.notifications.gainNotification+'</li><li id="pi-gainNotificationMinXP"><label for="gainNotificationMinXP">'+a.menu.notifications.gainNotificationMinXPLabel+'</label><input type="number" min="1" max="1000" step="1" value="'+u.minimumGain.xp+'" name="gainNotificationMinXP"/></li><li id="pi-gainNotificationMinPP"><label for="gainNotificationMinPP">'+a.menu.notifications.gainNotificationMinPPLabel+'</label><input type="number" min="1" step="1" value="'+u.minimumGain.pp+'" name="gainNotificationMinPP"/></li><li id="pi-userLevelUp">'+a.menu.notifications.userLevelUp+"</li></ul><h2>"+a.menu.about.title+'</h2><p style="display: none;">Plug-It '+pi._tool.getReadableVersion()+".<br>"+pi._tool.replaceString(a.menu.about.developedBy,{"plug-profile":'<a target="_blank" href="https://plug.dj/@/wibla" target="blank">WiBla</a><br>'})+pi._tool.replaceString(a.menu.about.followUs,{twitter:'<a target="_blank" href="https://twitter.com/plugit_dj" target="blank">Twitter</a><br>'})+pi._tool.replaceString(a.menu.about.joinDiscord,{discord:'<a target="_blank" href="https://discord.gg/DptCswA" target="blank">Discord</a><br>'})+'<a target="_blank" href="https://chrome.google.com/webstore/detail/plug-it-extension/bikeoipagmbnkipclndbmfkjdcljocej">'+a.menu.about.rateExtension+'</a><br><a target="_blank" href="https://crowdin.com/project/plug-it">'+a.menu.about.translate+'</a><br><a target="_blank" href="https://github.com/Plug-It/pi/issues">'+a.menu.about.reportBug+'</a><br><span id="pi-off">'+a.menu.about.shutdown+"</span></p></ul></div>")),$("head").append($('<link id="pi-menu-CSS" rel="stylesheet" type="text/css" href="'+d.styles.menu_css+'">')),$("#chat-popout-button").before('<div id="pi-delchat" class="chat-header-button"><i class="icon icon-chat"></i><i class="icon icon-delete"></i></div>'),$("#chat-popout-button").before('<div id="pi-afk" class="chat-header-button"><i class="icon pi-afk off"></i></div>'),$("#chat-popout-button").before('<div id="pi-toggleStream" class="chat-header-button"><i class="icon pi-toggleStream off"></i></div>'),h.plugOptions.settings.streamDisabled||$(".pi-toggleStream").removeClass("off"),window.modToolbar={init:function(e){(API.hasPermission(null,API.ROLE.BOUNCER)||e)&&($("#pi-rmvDJ, #pi-skip").length>0&&this.kill(),$("#playback-container").append($('<div id="pi-rmvDJ"><i class="icon icon-leave-waitlist"></i></div><div id="pi-skip"><i class="icon icon-skip"></i></div>').css({top:u.showVideo?"281px":"0px"})),void 0!==pi.dom&&(pi.dom.skip=$("#pi-rmvDJ")[0],pi.dom.rmvDJ=$("#pi-skip")[0]),$("#pi-rmvDJ").on("click",function(){pi.removeDJ()}),$("#pi-skip").on("click",function(){pi.forceSkip()}),$("#pi-rmvDJ, #pi-skip").on("mousewheel",pi._DOMEvent.volumeWheel))},kill:function(){$("#pi-rmvDJ, #pi-skip").remove(),delete pi.dom.rmvDJ,delete pi.dom.skip}},modToolbar.init(),$("#pi-logo, #pi-menu").on("click",function(e){"pi-logo"===e.target.id||"icon"===e.target.id?$("#pi-menu").toggle(250):"H2"!==e.target.tagName&&pi.menu(e.target.id.replace("pi-",""))}),$("#pi-menu h2").on("click",function(e){var t=$('#pi-menu h2+*:not([style*="display: none"])');0!==t.length&&t.not(e.target.nextSibling).slideToggle({duration:400,easing:"linear"}),$(this).next().slideToggle({duration:400,easing:"linear"})}),$("#pi-autoHideLogsAfter input").on("change",function(){u.AutoHideLogsAfter=parseInt(this.value)}),$("#pi-betterClearChatLimit input").on("change",function(){u.betterClearChatLimit=parseInt(this.value)}),$("#pi-chatLimit input").on("change",function(){u.chatLimit=parseInt(this.value)}),$("#pi-afkMessage input").on("change",function(){u.afkMessage=this.value}),$("#pi-songLength input").on("change",function(){u.songLength=parseInt(this.value)}),$("#pi-boothPosition input").on("change",function(){u.boothPosition=parseInt(this.value)}),$("#pi-gainNotificationMinXP input").on("change",function(){u.minimumGain.xp=parseInt(this.value)}),$("#pi-gainNotificationMinPP input").on("change",function(){u.minimumGain.pp=parseInt(this.value)}),$(window).on("resize",pi._DOMEvent.resize),$("#pi-menu input").on("blur",function(){pi._tool.saveSettings}),$("#pi-delchat").on("click",function(e){e.ctrlKey?API.sendChat("/clear"):e.shiftKey?(document.getSelection().removeAllRanges(),$("#chat .from.Plug-It").closest(".cm").remove()):pi.betterClearChat(u.betterClearChatLimit)}),$("#pi-afk").on("click",function(e){if(e.ctrlKey){var t=prompt("AFK message:",u.afkMessage);if(null===t||0===t.length)return;u.afkMessage=$("#pi-afkMessage input")[0].value=t}pi.menu("afkResponder")}),$("#pi-toggleStream").on("click",function(e){var t=h.plugOptions.settings.streamDisabled;t=!t,h.plugOptions.settings.streamDisabled=t,h.context.trigger("change:streamDisabled"),h.plugOptions.save()}),$("#now-playing-media").on("mouseenter",function(){pi._tool.tooltip(!0,"left",$(this).offset().left,0,this.innerText)}),$("#pi-rmvDJ").on("mouseenter",function(){var e=$(this).offset().left+$(this).width()/2,t=$(this).offset().top-$(this).height();pi._tool.tooltip(!0,"left",e,t,a.tooltips.rmvDJ)}),$("#pi-skip").on("mouseenter",function(){var e=$(this).offset().left+$(this).width()/2,t=$(this).offset().top-$(this).height();pi._tool.tooltip(!0,"left",e,t,a.tooltips.skip)}),$("#pi-delchat").on("mouseenter",function(){var e=$(this).offset().left+$(this).width()/2,t=$(this).offset().top-$(this).height();pi._tool.tooltip(!0,"right",e,t,a.tooltips.clearChat),$("#tooltip").css({transform:"translate(-100%, 0)"})}),$("#pi-afk").on("mouseenter",function(){var e=$(this).offset().left+$(this).width()/2,t=$(this).offset().top-$(this).height();pi._tool.tooltip(!0,"right",e,t,a.tooltips.afk),$("#tooltip").css({transform:"translate(-100%, 0)"})}),$("#pi-toggleStream").on("mouseenter",function(){var e=$(this).offset().left+$(this).width()/2,t=$(this).offset().top-$(this).height();pi._tool.tooltip(!0,"right",e,t,a.tooltips.toggleStream),$("#tooltip").css({transform:"translate(-100%, 0)"})}),$("#now-playing-media, #pi-rmvDJ, #pi-skip, #pi-delchat, #pi-afk, #pi-toggleStream").on("mouseleave",function(){pi._tool.tooltip()}),$("#woot, #grab, #meh").on("mouseenter",function(){if(u.showVotes){var e;switch(this.id){case"woot":e=b.woots;break;case"grab":e=b.grabs;break;case"meh":e=b.mehs;break;default:e=[]}pi._tool.showVotes(!0,this.id,e)}}),$("#woot, #grab, #meh").on("mouseleave",function(e){$(e.toElement).closest("#pi-votes").length||pi._tool.showVotes(!1)}),pi.dom={woot:$("#pi-woot")[0],join:$("#pi-join")[0],keyShortcut:$("#pi-keyShortcut")[0],chatCommands:$("#pi-chatCommands")[0],autoHideLogs:$("#pi-autoHideLogs")[0],autoHideLogsAfter:$("#pi-autoHideLogsAfter")[0],betterMeh:$("#pi-mutemeh")[0],afkResponder:$("#pi-afkResponder")[0],afkMessage:$("#pi-afkMessage")[0],navWarn:$("#pi-navWarn")[0],showVotes:$("#pi-showVotes")[0],betterClearChatLimit:$("#pi-betterClearChatLimit")[0],chatLimit:$("#pi-chatLimit")[0],skipNextMediaInHistory:$("#pi-skipNextMediaInHistory")[0],video:$("#pi-video")[0],soundcloudVisu:$("#pi-soundcloudVisu")[0],css:$("#pi-css")[0],customRanks:$("#pi-customRanks")[0],languageFlags:$("#pi-languageFlags")[0],friendsIcons:$("#pi-friendsIcons")[0],bg:$("#pi-bg")[0],oldChat:$("#pi-old-chat")[0],oldFooter:$("#pi-old-footer")[0],smallHistory:$("#pi-small-history")[0],smallFriends:$("#pi-small-friends")[0],smallPlaylists:$("#pi-small-playlists")[0],showDeletedMsg:$("#pi-showDeletedMsg")[0],confirmDelete:$("#pi-confirmDelete")[0],userInfo:$("#pi-userInfo")[0],stuckSkip:$("#pi-stuckSkip")[0],lengthA:$("#pi-lengthA")[0],songLength:$("#pi-songLength")[0],historyAlert:$("#pi-historyA")[0],systemNotifications:$("#pi-systemNotifications")[0],songStats:$("#pi-songStats")[0],boothAlert:$("#pi-boothAlert")[0],boothPosition:$("#pi-boothPosition")[0],userJoin:$("#pi-userJoin")[0],userLeave:$("#pi-userLeave")[0],userWoot:$("#pi-userWoot")[0],userGrab:$("#pi-userGrab")[0],mehA:$("#pi-userMeh")[0],guestJoin:$("#pi-guestJoin")[0],guestLeave:$("#pi-guestLeave")[0],friendRoomChange:$("#pi-friendRoomChange")[0],friendConnect:$("#pi-friendConnect")[0],friendDisconnect:$("#pi-friendDisconnect")[0],unfriended:$("#pi-unfriended")[0],gainNotification:$("#pi-gainNotification")[0],gainNotificationMinXP:$("#pi-gainNotificationMinXP")[0],gainNotificationMinPP:$("#pi-gainNotificationMinPP")[0],userLevelUp:$("#pi-userLevelUp")[0],off:$("#pi-off")[0],rmvDJ:$("#pi-rmvDJ")[0],skip:$("#pi-skip")[0],DelChat:$("#pi-delchat")[0],stream:$("#playback-container")[0],playback:$("#playback")[0]},delete pi._load,pi._tool.log(pi._tool.replaceString(a.log.loaded,{version:pi._tool.getReadableVersion()})+" "+((new Date).getTime()-l)+"ms"),i||(pi._tool.log(a.log.help,"info chat"),pi._tool.log(a.log.preRelease,"warn chat")),pi.menu("init"),pi.muteMeh(),$("#pi-status").css({opacity:"0"}),setTimeout(function(){$("#pi-status").remove()},250),pi._tool.getRoomSettings()},_reload:function(e){"string"==typeof e&&"roomChange"===e?pi._tool.log(a.info.roomChange,"info"):pi._tool.log(a.log.reloading),pi._close(),$.getScript(scriptURL)},_close:function(){for(var e in pi._event)API.off(e,pi._event[e]);pi._tool.plugSocketHook.kill(),h.context.off("chat:receive",pi._modulesEvent.chatReceive),h.context._events["chat:delete"][0].callback=h.originalChatDelete,h.context.off("change:streamDisabled",pi._modulesEvent.streamDisabled),h=null,window.scriptURL=d.script,window.onbeforeunload=null,clearInterval(friendsOnline),clearInterval(checkIfRoomChanged),friendsOnline=null,roomURL=null,checkIfRoomChanged=null,$(window).off("keydown",pi._DOMEvent.keydown),$(window).off("dblclick",pi._DOMEvent.translate),$(window).off("resize",pi._DOMEvent.resize),$("#volume, #playback-controls").off("mousewheel",pi._DOMEvent.mousewheel),$(".button.staff").off("click",pi._DOMEvent.collideRanks),$("#chat-popout-button").off("click",pi._DOMEvent.popout),$("#chat-input-field").off("input",pi._DOMEvent.chatAutocompletion),$(document).off("ajaxSuccess",pi._DOMEvent.updateRoomSettings),$(".group").css("cursor",""),$(".room-background").show(),$('[id*="pi-"], .icon[class*="pi-"]').each(function(){this.remove()}),$("#now-playing-media, #woot, #grab, #meh").off("mouseenter"),$("#now-playing-media, #woot, #grab, #meh").off("mouseleave"),u.showVideo||(pi._tool.getPlugSettings().videoOnly?(pi.dom.playback.style.height=window.innerHeight-185+"px",$(pi.dom.stream).css({visibility:"visible",height:"100%"})):(pi.dom.playback.style.height="271px",$(pi.dom.stream).css({visibility:"visible",height:"281px"})),$("#playback-controls, #no-dj").css("visibility","visible")),pi._extendAPI.kill(),pi=null},_extendAPI:{init:function(){API.GLOBAL_ROLE={ADMIN:5e3,AMBASSADOR:3e3,MODERATOR:2500,PLOT:750,PROMOTER:500},API.GUEST_JOIN="guestJoin",API.GUEST_LEAVE="guestLeave",API.EARN="earn",API.moderateForceQuit=function(){API.hasPermission(null,API.ROLE.BOUNCER)&&API.enabled&&$.ajax({url:"/_/booth/remove/"+API.getDJ().id,method:"DELETE"})},API.getUserByName=function(e){if(API.enabled){if(void 0===e)throw new Error("A name must be provided.");var t=API.getUsers().filter(function(t){return t.username===e});return t.length>0?t[0]:null}},API.getUserByID=function(e,t){API.enabled&&!isNaN(e)&&"function"==typeof t&&$.ajax({url:"/_/users/"+e,success:function(e){t(e.data[0])},error:function(e){console.error(e)}})},API.addFriendByID=function(e){!isNaN(e)&&API.enabled&&$.ajax({type:"POST",url:"/_/friends",data:JSON.stringify({id:e}),success:function(){API.getUserByID(e,function(e){h.context.trigger("notify","icon-add-friend",h.lang.messages.friendRequest.split("%NAME%").join(e.username))})},error:function(e){console.error(e)},dataType:"json",contentType:"application/json"})},API.moderateKickUser=function(e,t){if(!(arguments.length<2)&&API.enabled){var o;o=t>=86400?"f":t>=3600?"d":"h",$.ajax({type:"POST",url:"/_/bans/add",data:JSON.stringify({userID:e,reason:1,duration:o}),dataType:"json",contentType:"application/json",error:function(e){void 0!==e.responseJSON.data[0]?pi._tool.log(["Could not ban user: ",e.responseJSON.data[0]],"error"):pi._tool.log(["Could not ban user: ",e],"error")},success:function(){pi._tool.log("User was succesfully banned for "+t+" seconds.","chat"),setTimeout(function(){$.ajax({type:"DELETE",url:"/_/bans/"+e,error:function(e){pi._tool.log(["Could not unban user: ",e],"error")},success:function(){pi._tool.log("User was unbanned.","success chat")}})},1e3*t)}})}},API.gift=function(e,t,o){if(!(isNaN(e)||isNaN(t)||!API.enabled||API.getUser().sub<1)){var i=API.getUser(e);i.username?(o="string"==typeof o?o:i.username,t=void 0===t?25:t,pi._tool.showGiftDialog(e,o,t)):API.getUserByID(e,function(i){o="string"==typeof o?o:i.username,t=void 0===t?25:t,pi._tool.showGiftDialog(e,o,t)})}},API.getActivePlaylist=function(){if(API.enabled){var e,t,o,i,a;t=(e=$("#playlist-menu .row.selected")).children()[1].innerText,i=e.children()[2].innerText,a=JSON.parse(_.find(require.s.contexts._.defined,function(e){return e&&e._read})._read())[1].p;for(var s in a)a[s].name===t&&(o=a[s].id);return{name:t,id:o,itemCount:i}}},API.getRoomName=function(){if(API.enabled)try{return h.room.get("name")}catch(e){return $("#room-name span").text()}},API.moderateDeleteChat=function(e){API.enabled&&e&&$.ajax({url:"/_/chat/"+e,method:"DELETE"})}},kill:function(){delete API.GLOBAL_ROLE,delete API.GUEST_JOIN,delete API.GUEST_LEAVE,delete API.EARN,delete API.moderateForceQuit,delete API.getUserByName,delete API.getUserByID,delete API.addFriendByID,delete API.moderateKickUser,delete API.gift,delete API.getActivePlaylist,API.getRoomName()}},_tool:{applyRoomSettings:function(){for(var e in g){for(var t in g[e]){if("room"===t&&g[e][t]!==location.pathname.slice(1))return pi._tool.log("Could not load room settings: room value must match room URL.","error");if(void 0!==g[e][t].import)g[t]=g[e][t].import[0],g.rule=g[e][t].rule;else if("rules"===t)for(var o in g[e][t])void 0===g[t]&&(g[t]={}),"string"==typeof g[e][t][o]?g[t][o]="true"===g[e][t][o]:g[t][o]=g[e][t][o];else g[t]=g[e][t]}delete g[e]}if(void 0!==g.css){var i=$("#pi-room-style");i.length&&i.remove(),i=$('<li id="pi-room-style">'+g.room+" style</li>"),pi.dom.roomStyle=i[0],pi.dom.roomStyle.className=u.roomStyle?"pi-on":"pi-off",$("#pi-css").before(i),u.roomStyle&&(pi.toggleStyle("roomStyle"),pi._tool.log("This room is using a custom style made by "+g.author+", you can disable it via the menu."))}},checkForUpdates:function(e){o("https://api.github.com/repos/Plug-It/pi/commits/pre-release",function(t){thisCommit.sha!==t.sha&&(e?(pi._tool.log(a.log.forcingReload),pi._reload()):pi._tool.log(pi._tool.replaceString(a.log.updateAvailable,{whatsnew:t.commit.message}),"info chat",function(){pi._reload()}))})},getFriends:function(e){b.floodAPI||$.ajax({url:"/_/friends",success:function(t){e(t.data)}})},getPlaylist:function(e,t){if(!isNaN(e)&&"function"==typeof t&&!b.floodAPI){var o=_.find(require.s.contexts._.defined,function(e){return e&&e._read})._read(),i=(o=JSON.parse(o))[1].p[e].items;if(0!==Object.keys(i).length){var a=[];for(var s in i)a.push(o[1].m[s]);t(a,!0)}else $.ajax({url:"/_/playlists/"+e+"/media",success:function(e){t(e.data,!1)}})}},getPlaylists:function(e){"function"!=typeof e||b.floodAPI||$.ajax({url:"/_/playlists",success:function(t){e(t.data.sort(function(e,t){return e.name.localeCompare(t.name)}))}})},getPlugSettings:function(e){void 0===e&&(e=API.getUser().id);for(var t=JSON.parse(localStorage.getItem("settings")),o=1;o<20;o++)if(void 0!==t[o][e])return t[o][e]},getRank:function(e){var t=[];e?API.getUser(e):e=API.getUser().id;for(var o in s)for(var i in s[o])e==s[o][i]&&t.push(o);return-1!==u.bot.indexOf(e)&&t.push("Bot"),-1!==u.discordbot.indexOf(e)&&t.push("Discord Bot"),t},getReadableVersion:function(){var e="";return pi.version.pre&&(e=" Pre "+pi.version.pre),pi.version.major+"."+pi.version.minor+"."+pi.version.patch+e},getRoomRules:function(e){return void 0===g.rules||(void 0===g.rules[e]||g.rules[e])},getRoomSettings:function(){b.floodAPI||$.getJSON("/_/rooms/state",function(e){function t(){Object.keys(g).length===s.length&&pi._tool.applyRoomSettings()}var o=(e=e.data[0]).meta.description,i=new RegExp("@(pi|p3|rcs)=(https?://[^\\@,;]*json)","ig");if(i.test(o))for(var s=o.match(i),n=0;n<s.length;n++)!function(e){var o=s[e].slice(1,s[e].indexOf("="));$.ajax({url:s[e].replace(/@(pi|p3|rcs)=/gi,""),success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),g[o]=e,t()},error:function(e){pi._tool.log(pi._tool.replaceString(a.error.cannotLoadScriptRoomSettings,{script:o,error:e}),"error console")}})}(n)})},isRank:function(e,t){if(!e)return null;var o=pi._tool.getRank(t);for(var i in o)if(o[i]=o[i].toLowerCase(),e=e.toLowerCase(),o[i]==e)return!0;return!1},loadEmote:function(e){"string"==typeof e&&("tasty"===e?$.ajax({url:d.emotes.tasty,success:function(e){f.tastycat=e.emotes}}):"twitch"===e?$.ajax({url:d.emotes.twitch,success:function(e){f.twitch={};for(var t in e.emotes)f.twitch[t]=e.template.small.replace("{image_id}",e.emotes[t].image_id)}}):"twitchSub"===e?$.ajax({url:d.emotes.twitchSub,success:function(e){f.twitchSub={};for(var t in e.unknown_emotes.emotes)f.twitchSub[e.unknown_emotes.emotes[t].code]=e.template.small.replace("{image_id}",e.unknown_emotes.emotes[t].image_id);for(var o in e.channels)for(t in e.channels[o].emotes)f.twitchSub[e.channels[o].emotes[t].code]=e.template.small.replace("{image_id}",e.channels[o].emotes[t].image_id)}}):"betterTTV"===e&&$.ajax({url:d.emotes.betterDiscord,success:function(e){f.betterTTV=JSON.parse(e);for(var t in f)f.betterTTV[t]="https://cdn.betterttv.net/emote/"+f.betterTTV[t]+"/1x";$.ajax({url:d.emotes.betterTTV,success:function(e){for(var t in e.emotes)f.betterTTV[e.emotes[t].regex]="https:"+e.emotes[t].url}})}}))},log:function(e,t,o){for(var i=[],s=arguments.length-3;s-- >0;)i[s]=arguments[s+3];var n,r,l;if(void 0===t&&(t="log"),t.indexOf("log")>-1?(n="log",r="log"):t.indexOf("info")>-1?(n="info",r=":information_source:"):t.indexOf("warn")>-1?(n="warn",r=":warning:"):t.indexOf("error")>-1?(n="error",r=":exclamation:"):t.indexOf("debug")>-1?(n="debug",r=":octocat:"):t.indexOf("success")>-1?(n="success",r=":white_check_mark:"):(n="log",r="log"),-1===t.indexOf("console")){var c=pi._tool.getPlugSettings().chatTimestamps;if(c){var p=(l=new Date).getHours(),d=l.getMinutes();if(d=d<10?"0"+d:d,12==c){var g;p>=12?(g="pm",p-=12):g="am",l=p+":"+d+g}else l=(p=p<10?"0"+p:p)+":"+d}var m=$('<div class="cm pi-'+n+' message deletable"><div class="delete-button" style="display: none;">'+a.glossary.delete+'</div><div class="badge-box"><i class="bdg bdg-piLogo"></i></div><div class="msg"><div class="from Plug-It">'+("log"===r?'<i class="icon icon-pi"></i>':emoji.replace_colons(r))+'<span class="un">[Plug-It]</span><span class="timestamp" style="display: '+(c?"inline-block":"none")+';">'+l+'</span></div><div class="text cid-undefined">'+(Array.isArray(e)?e.join("<br />"):e.replace(/\\n|\n/g,"<br />"))+"</div></div></div>");m.on("mouseenter",function(){m.find(".delete-button")[0].style.display="block"}),m.on("mouseleave",function(){m.find(".delete-button")[0].style.display="none"}),m.find(".delete-button").on("click",function(){m.remove()});var f=$("#chat-messages");if(f.height()+f.scrollTop()==f[0].scrollHeight&&f[0].scrollHeight>f.height())var h=setInterval(function(){$(m).length>0&&(f.scrollTop(f[0].scrollHeight),clearInterval(h))},5);$("#chat-messages").append(m),void 0!==window.popout&&$("#chat-messages",popout.document).append(m),u.autoHideLogs&&setTimeout(function(){document.hasFocus()?$(m).fadeOut(1e3,"linear",function(){return $(m).remove()}):window.onfocus=function(){setTimeout(function(){$(m).fadeOut(1e3,"linear",function(){return $(m).remove()})},1e3*u.autoHideLogsAfter),window.onfocus=void 0}},1e3*u.autoHideLogsAfter),API.chatLog("Don't pay attention to this message please."),"undefined"==typeof popout?$(".cm.log:last").length&&$(".cm.log:last")[0].remove():$(".cm.log:last",popout.document).length&&$(".cm.log:last",popout.document)[0].remove()}if(-1===t.indexOf("chat")&&("success"===n&&(n="log"),console[n]("%c[%cPlug-It%c]%c","color: #EEE","color: #ABDA55","color: #EEE","",e)),-1===t.indexOf("console")){var b={div:m,text:m.find(".text")[0].innerText,edit:function(e){return m.find(".text")[0].innerHTML=Array.isArray(e)?e.join("<br>"):e.toString(),this},changeType:function(e){if(e===n)return b;m.toggleClass("pi-"+n+" pi-"+e);var t,o;switch(e){case"log":(t=document.createElement("i")).className="icon icon-pi";break;case"info":t=$.parseHTML(emoji.replace_colons(":information_source:"))[0];break;case"warn":t=$.parseHTML(emoji.replace_colons(":warning:"))[0];break;case"error":t=$.parseHTML(emoji.replace_colons(":exclamation:"))[0];break;case"debug":t=$.parseHTML(emoji.replace_colons(":octocat:"))[0];break;case"success":t=$.parseHTML(emoji.replace_colons(":white_check_mark:"))[0]}return(o=m[0].children[2].children[0]).replaceChild(t,o.firstChild),n=e,this},removeCallback:function(){return m.off("click"),m.css("cursor",""),this},delete:function(){return m.remove(),this}};return"function"==typeof o&&(m.css("cursor","pointer"),m.on("click",function(e){o.call.apply(o,[b].concat(i))})),b}},modal:function(e,t,o,i){function s(){"custom-bg"===t&&pi.changeBG(!1,r.find('input[name="url"]')[0].value),"function"==typeof o&&o(),pi._tool.tooltip(!1),pi._tool.modal(!1)}function n(){pi._tool.tooltip(!1),pi._tool.modal(!1)}if(e){var r;switch(t){case"custom-bg":var l=$(".room-background").css("background-image").split('"')[1];(r=$('<div id="dialog-media-update" class="dialog" style="height: auto;"><div class="dialog-frame"><span class="title">'+a.modal.customBGTitle+'</span><i class="icon icon-dialog-close"></i></div><div class="dialog-body" style="height:300px;overflow-y:auto;"><div class="dialog-input-container" style="position:relative;top:10px;"><span class="dialog-input-label">URL</span><div class="dialog-input-background"><input name="url" type="text" placeholder=".jpg .png .gif.." value="'+(null!==u.customBGURL?u.customBGURL:"Custom background URL")+'"></div><p style="position:relative;top:55px;">'+a.modal.additionalBackgrounds+'</p><figure style="position:relative;top:65px;"><figcaption>Plug\'s original backgrounds</figcaption><div class="thumbnail" style="background: url('+l+') 0 0 / 150px 84px" data-src="default" alt="Plug\'s background"></div><div class="thumbnail" style="background-position: -150px -84px" data-src="https://dl.dropboxusercontent.com/s/x2m4e4go92ecwn5/2k13winter.jpg" alt="Plug\'s 2013 winter background"></div><div class="thumbnail" style="background-position: -300px -84px" data-src="https://dl.dropboxusercontent.com/s/06aezou89twexfi/2k14hw.jpg" alt="Plug\'s 2014 halloween background"></div><div class="thumbnail" style="background-position: -450px -84px" data-src="https://dl.dropboxusercontent.com/s/pru886rp6sfhguo/2k14minecraft.jpg" alt="Plug\'s 2014 Minecraft background"></div><div class="thumbnail" style="background-position: -600px -84px" data-src="https://dl.dropboxusercontent.com/s/yzwlvq9uk4vgyps/2k14tc.jpg" alt="Plug\'s 2014 TastyCat background"></div><div class="thumbnail" style="background-position: -750px -84px" data-src="https://dl.dropboxusercontent.com/s/dw1g3g87clubjor/2k14tiki.jpg" alt="Plug\'s 2014 Tiki background"></div><div class="thumbnail" style="background-position: 0 -168px" data-src="https://dl.dropboxusercontent.com/s/n0vdz30m4edpvnm/2k14winter.jpg" alt="Plug\'s 2014 winter background"></div><div class="thumbnail" style="background-position: -150px -168px" data-src="https://dl.dropboxusercontent.com/s/tt8385hnd61vu7t/2k15beach.jpg" alt="Plug\'s 2015 Beach background"></div><div class="thumbnail" style="background-position: -300px -168px" data-src="https://dl.dropboxusercontent.com/s/tdiyz39fpepdamt/2k15diner.jpg" alt="Plug\'s 2015 Diner background"></div><div class="thumbnail" style="background-position: -450px -168px" data-src="https://dl.dropboxusercontent.com/s/gdw01htqn3kb5ul/2k15island.jpg" alt="Plug\'s 2015 Island background"></div><div class="thumbnail" style="background-position: -600px -168px" data-src="https://dl.dropboxusercontent.com/s/f05ranw1gjmrekj/2k15nyc.jpg" alt="Plug\'s 2015 New York City background"></div><div class="thumbnail" style="background-position: -750px -168px" data-src="https://dl.dropboxusercontent.com/s/1e7isnah6dz8mks/2k15sea.jpg" alt="Plug\'s 2015 Sea background"></div><div class="thumbnail" style="background-position: 0 -252px" data-src="https://dl.dropboxusercontent.com/s/godmbmvf7iso1hp/2k15tasty.jpg" alt="Plug\'s 2015 Tasty background"></div></figure><figure style="position:relative;top:65px;"><figcaption>'+a.modal.otherChoices+'</figcaption><div class="thumbnail" style="background-position: 0 0" data-src="https://dl.dropboxusercontent.com/s/guglxeg29z8xdyc/Plug-It.jpg" alt="Plug-It background"></div><div class="thumbnail" style="background-position: -150px 0" data-src="https://dl.dropboxusercontent.com/s/okazf75swvx5n3r/Plug-It-old.jpg" alt="Plug-It Old background"></div><div class="thumbnail" style="background-position: 0 -336px" data-src="https://dl.dropboxusercontent.com/s/rs4yhqsmp557q46/2k14lounge.jpg" alt="lounge background"></div><div class="thumbnail" style="background-position: -150px -336px" data-src="https://dl.dropboxusercontent.com/s/rayu1kdzve55ynd/2k14worldonfire.jpg" alt="WorldOnFire background"></div><div class="thumbnail" style="background-position: -300px -336px" data-src="https://dl.dropboxusercontent.com/s/hwh25f5o39a4rft/2k15rtreesmusic.jpg" alt="/r/trees background"></div><div class="thumbnail" style="background-position: -450px -336px" data-src="https://dl.dropboxusercontent.com/s/rg7egwly5m41z5a/2k15thenation.jpg" alt="The Nation background"></div><div class="thumbnail" style="background-position: -600px -336px" data-src="https://dl.dropboxusercontent.com/s/3kg8riyabo08y9a/JGI5G7x.jpg" alt="Unknown"></div><div class="thumbnail" style="background-position: -750px -336px" data-src="https://dl.dropboxusercontent.com/s/gb3ogpqpg5mi15v/minecraft.jpg" alt="Minecraft"></div><div class="thumbnail" style="background-position: 0 -420px" data-src="https://dl.dropboxusercontent.com/s/nvc6xtx17oqlzlv/NYC-Custom.jpg" alt="NYC - Custom"></div><div class="thumbnail" style="background-position: -150px -420px" data-src="https://dl.dropboxusercontent.com/s/30zbmkdi31jtxtl/plugalpha.jpg" alt="Plug Alpha"></div><div class="thumbnail" style="background-position: -300px -420px" data-src="https://dl.dropboxusercontent.com/s/idchvsywitwvns5/plugalphaLounge.jpg" alt="Plug Alpha Lounge"></div></figure><p style="position:relative;top:70px;">'+a.modal.customBGDisclaimer+'</p></div></div><div class="dialog-frame"><div class="button cancel"><span>'+a.glossary.cancel+'</span></div><div class="button submit"><span>'+a.glossary.save+"</span></div></div></div>")).on("mouseover",".thumbnail",function(e){var t=$(this).offset().left+$(this).width()/2,o=$(this).offset().top;pi._tool.tooltip(!0,"right",t,o,this.attributes.alt.value),$("#tooltip").css({transform:"translate(-100%, -175%)"})}),r.on("mouseleave",".thumbnail",function(e){pi._tool.tooltip()}),r.on("click",".thumbnail",function(e){"default"===e.target.dataset.src?pi.changeBG(!0):pi.changeBG(!1,e.target.dataset.src),pi._tool.tooltip(!1),pi._tool.modal(!1)});break;case"confirmDelete":r=$('<div id="dialog-media" class="dialog"><div class="dialog-frame"><span class="title">'+a.modal.confirmDeleteTitle+'</span><i class="icon icon-dialog-close"></i></div><div class="dialog-body"><p>'+i.un+": "+i.message+'</p></div><div class="dialog-frame"><div class="button cancel"><span>'+a.glossary.cancel+'</span></div><div class="button submit"><span>'+a.glossary.delete+"</span></div></div></div>");break;default:return pi._tool.log("Invalid dialog type.","console error")}r.on("click",".dialog-frame i, .button.cancel",function(){n()}),$("#dialog-container").on("click",function(e){"dialog-container"===e.target.id&&n()}),r.on("click",".button.submit",function(){s()}),r.on("submit",'input[name="url"]',function(){s()}),$("#dialog-container").append(r),$("#dialog-container").show()}else e||($("#dialog-container").hide(),$("#dialog-container").html(""))},notify:function(e,t,o){var i={body:t,icon:"https://raw.githubusercontent.com/Plug-It/pi/pre-release/img/other/icon-54-hover.png"},a=new Notification(e,i);for(var s in o)a[s]=o[s]},plugSocketHook:{init:function(){var e=this;this.socket=r(),this.socket&&this.onConnect();var t=WebSocket;window.WebSocket=function(o){var i=new t(o);return _.defer(function(){e.socket=r(),e.onConnect()}),i},WebSocket.prototype=t.prototype,this.WS=t},kill:function(){this.WS&&(window.WebSocket=this.WS),this.advice&&this.advice.remove(),this.WS=null,this.advice=null,this.socket=null},onConnect:function(){this.advice&&this.advice.remove(),this.advice=e(this.socket,"onmessage",function(e){"h"!==e.data&&JSON.parse(e.data).forEach(function(e){try{switch(e.a){case"chat":break;case"chatDelete":pi._modulesEvent.chatDelete(e);break;case"earn":if(u.gainNotification){var t=e.p.pp-API.getUser().pp,o=e.p.xp-API.getUser().xp;API.trigger(API.EARN,{pp:t,xp:o})}break;case"floodAPI":API.enabled=!1,b.floodAPI=!0;var i=pi._tool.log(a.error.APIFloodDetected,"error");setTimeout(function(){API.enabled=!0,b.floodAPI=!1,i.edit("API reactivated").changeType("info")},1e4);break;case"modMute":"o"===e.p.d&&API.hasPermission(null,API.ROLE.BOUNCER)&&pi._tool.log(e.p.t+" has been unmuted by "+e.p.m+".","chat info");break;case"modStaff":e.p.u.forEach(function(e,t,o){var i=API.getUser();e.i===i.id&&(e.p<=1&&i.role>e.p?modToolbar.kill():e.p>=2&&i.role<e.p&&modToolbar.init(!0),0===e.p&&($("#footer-user .info .name i")[0].className="icon"))});break;case"userJoin":case"userLeave":!e.p.guest&&0!==e.p||!u.guestJoin&&!u.guestLeave||("userJoin"===e.a&&u.guestJoin?API.trigger(API.GUEST_JOIN,h.room.get("guests")+1):"userLeave"===e.a&&u.guestLeave&&API.trigger(API.GUEST_LEAVE,h.room.get("guests")-1));break;case"userUpdate":u.userLevelUp&&e.p.level?pi._tool.log("User leveled up: "+API.getUser(e.p.i).username+" to level "+e.p.level+" !","info"):e.p.badge||e.p.avatarID||console.log(e);break;case"roomWelcomeUpdate":pi._tool.log(API.getUser(e.p.u).username+" edited the room's welcome message to:\n"+e.p.w,"console info");break;case"roomDescriptionUpdate":pi._tool.log(API.getUser(e.p.u).username+" edited the room's description to:\n"+e.p.d,"console info"),g={},pi._tool.getRoomSettings();break;case"advance":case"djListCycle":case"djListUpdate":case"grab":case"playlistCycle":case"plugMessage":case"vote":break;default:pi._tool.log(e,"console info")}}catch(e){pi._tool.log(["error while parsing socket message",e],"console error")}"chatDelete"!==e.a&&h.context.trigger("socket:"+e.a,e.p)})})}},replaceString:function(e,t){if("string"!=typeof e||"object"!=typeof t)return e;for(var o in t)e=e.split("%%"+o.toUpperCase()+"%%").join(t[o]);return e},saveSettings:function(){localStorage.setItem("pi-settings",JSON.stringify(u))},setPlugSettings:function(e,t){for(var o=["videoOnly","chatTimestamps","emoji","tooltips","chatImages","notifyDJ","notifyScore","notifyFriendJoin","nsfw","friendAvatarsOnly"],i=0;i<o.length;i++)if(e==o[i]&&!b.floodAPI){var a={};a[e]=t,$.ajax({type:"PUT",url:"/_/users/settings",data:JSON.stringify(a),error:function(e){pi._tool.log(e.responseJSON.data[0],"error console")},dataType:"json",contentType:"application/json"})}for(var s=JSON.parse(localStorage.getItem("settings")),n=API.getUser().id,i=1;i<5;i++)if(void 0!==s[i]&&void 0!==s[i][n])for(var r in s[i][n])r==e&&(s[i][n][r]=t);localStorage.setItem("settings",JSON.stringify(s))},showGiftDialog:function(e,t,o){h.context.dispatch(new h.ShowDialogEvent(h.ShowDialogEvent.SHOW,new h.GiftSendDialog({model:new h.User({id:e,username:t})}))),$("#dialog-gift-send .amount input")[0].value=o},showVotes:function(e,t,o){if(e){$("#pi-votes").length&&pi._tool.showVotes(!1);var i="";if(0!==o.length)for(var a=0;a<o.length;a++)i+="<li>"+o[a].rawun+"</li>\n";var s=$('<div id="pi-votes" class="'+t+'"><div id="header">'+$("#"+t+" .label")[0].innerText.replace("!","")+"s</div><ul>"+i+"</ul></div>");s.on("mouseleave",function(){this.remove()}),$("#vote").append(s)}else for(var n=$("#pi-votes");n.length;)n.remove(),n=$("#pi-votes")},tooltip:function(e,t,o,i,a){if(pi._tool.getPlugSettings().tooltips)if(e){$("#tooltip").length&&$("#tooltip").remove();var s=$('<div id="tooltip" class="'+t+'" style="top: '+i+"px; left: "+o+'px;"><span>'+a+'</span><div class="corner"></div></div>');$("body").append(s)}else $('[id="tooltip"]').remove()}},afk:function(e){"undefined"==typeof originalPlaceholder&&(window.originalPlaceholder=$("#chat-input-field")[0].placeholder),u.afk?($("#chat-input-field")[0].disabled=!0,$("#chat-input-field")[0].placeholder=a.userchat.inputDisabled,pi.dom.afkResponder.className="pi-on",$("#pi-afk .pi-afk").removeClass("off")):($("#chat-input-field")[0].disabled=!1,$("#chat-input-field")[0].placeholder=originalPlaceholder,pi.dom.afkResponder.className="pi-off",$("#pi-afk .pi-afk").addClass("off"))},autojoin:function(){var e=API.getDJ();if(u.autoDJ&&pi._tool.getRoomRules("allowAutojoin"))if(void 0!==e){if(e.id!==API.getUser().id&&-1===API.getWaitListPosition())switch(API.djJoin()){case 1:pi._tool.log(a.error.autoJoin1,"error chat");break;case 2:pi._tool.log(a.error.autoJoin2,"error chat");break;case 3:pi._tool.log(a.error.autoJoin3,"error chat")}}else API.djJoin()},autowoot:function(){u.autoW&&!$("#meh").is(".selected")&&pi._tool.getRoomRules("allowAutowoot")&&$("#woot")[0].click()},betterClearChat:function(e){var t=$("#chat-messages > div").toArray();e<t.length&&t.forEach(function(t,o,i){o+e<i.length&&$(t).remove()})},changeBG:function(e,t){e?($(".room-background").show(),$("#pi-background").hide(),$("i.torch").length&&($("i.torch").show(),$("i.torch.right").show()),u.customBG=!1,pi.dom.bg.className="pi-off"):(t=(void 0!==t||u.customBGURL.length)&&"string"==typeof t?t:d.images.background,$(".room-background").hide(),$("#pi-background").show(),$("#pi-background").css("background","url("+t+") no-repeat"),$("i.torch").length&&($("i.torch").hide(),$("i.torch.right").hide()),u.customBG=!0,u.customBGURL=t,pi.dom.bg.className="pi-on"),pi._tool.saveSettings()},eta:function(e){var t;if(API.getUser().id==API.getDJ().id)return e&&pi._tool.log(a.info.youPlay,"info chat"),null;if(-1==API.getWaitListPosition())return e&&pi._tool.log(a.info.notInWaitList,"info chat"),null;if(0==API.getWaitListPosition())if((t=API.getTimeRemaining())>=3600)t=(s=Math.floor(t/60))+"h"+(o=t%60)+"m";else if(t>=60){var o=Math.floor(t/60),i=t%60;etasS=i<10?"0"+i:i,t=o+"m"+i+"s"}else t+="s";else if(t=4*API.getWaitListPosition()*60,(t+=API.getTimeRemaining())>=3600){var s=Math.floor(t/60/60);t=s+"h"+(o=t%60)+"m"}else t=(o=Math.floor(t/60))+"m"+(i=t%60)+"s";return e&&pi._tool.log(pi._tool.replaceString(a.log.eta,{time:t}),"info chat"),t},forceSkip:function(){"false"==sessionStorage.getItem("modSkipWarn")?(sessionStorage.setItem("modSkipWarn","true"),pi._tool.log(a.warn.confirmSkip,"warn chat")):(sessionStorage.setItem("modSkipWarn","false"),API.moderateForceSkip())},hideStream:function(){u.showVideo?(pi._tool.getPlugSettings().videoOnly?(pi.dom.playback.style.height=window.innerHeight-185+"px",$(pi.dom.stream).css({visibility:"visible",height:"100%"})):(pi.dom.playback.style.height="271px",$(pi.dom.stream).css({visibility:"visible",height:"281px"})),API.hasPermission(null,API.ROLE.BOUNCER)&&$([pi.dom.rmvDJ,pi.dom.skip]).css("top","281px"),$("#playback-controls, #no-dj").css("visibility","visible")):(pi.dom.playback.style.height="0px",$(pi.dom.stream).css({visibility:"hidden",height:"0"}),API.hasPermission(null,API.ROLE.BOUNCER)&&$([pi.dom.rmvDJ,pi.dom.skip]).css("top","0"),$("#playback-controls, #no-dj").css("visibility","hidden"))},menu:function(e){switch(e){case"woot":u.autoW=!u.autoW,pi.dom.woot.className=u.autoW?"pi-on":"pi-off",pi.autowoot();break;case"join":u.autoDJ=!u.autoDJ,pi.dom.join.className=u.autoDJ?"pi-on":"pi-off",pi.autojoin();break;case"keyShortcut":u.keyboardShortcuts=!u.keyboardShortcuts,pi.dom.keyShortcut.className=u.keyboardShortcuts?"pi-on":"pi-off";break;case"chatCommands":u.chatCommands=!u.chatCommands,pi.dom.chatCommands.className=u.chatCommands?"pi-on":"pi-off";break;case"autoHideLogs":u.autoHideLogs=!u.autoHideLogs,pi.dom.autoHideLogs.className=u.autoHideLogs?"pi-on":"pi-off";break;case"mutemeh":u.betterMeh=!u.betterMeh,pi.dom.betterMeh.className=u.betterMeh?"pi-on":"pi-off",pi.muteMeh();break;case"afkResponder":u.afk=!u.afk,pi.afk();break;case"navWarn":u.navWarn=!u.navWarn,pi.dom.navWarn.className=u.navWarn?"pi-on":"pi-off";break;case"showVotes":u.showVotes=!u.showVotes,pi.dom.showVotes.className=u.showVotes?"pi-on":"pi-off";break;case"skipNextMediaInHistory":u.skipNextMediaInHistory=!u.skipNextMediaInHistory,pi.dom.skipNextMediaInHistory.className=u.skipNextMediaInHistory?"pi-on":"pi-off";break;case"video":u.showVideo=!u.showVideo,pi.dom.video.className=u.showVideo?"pi-off":"pi-on",pi.hideStream();break;case"soundcloudVisu":u.scVisu=!u.scVisu,pi.dom.soundcloudVisu.className=u.scVisu?"pi-on":"pi-off",pi.soundcloudVisu();break;case"room-style":u.roomStyle=!u.roomStyle,pi.dom.roomStyle.className=u.roomStyle?"pi-on":"pi-off",pi.toggleStyle("roomStyle");break;case"css":u.CSS=!u.CSS,pi.dom.css.className=u.CSS?"pi-on":"pi-off",pi.toggleStyle("customStyle");break;case"customRanks":u.customRanks=!u.customRanks,pi.dom.customRanks.className=u.customRanks?"pi-on":"pi-off",pi.toggleStyle("customRanks");break;case"languageFlags":u.languageFlags=!u.languageFlags,pi.dom.languageFlags.className=u.languageFlags?"pi-on":"pi-off",u.languageFlags?$(".un ~ .pi-languageFlags").show():$(".un ~ .pi-languageFlags").hide();break;case"friendsIcons":u.friendsIcons=!u.friendsIcons,pi.dom.friendsIcons.className=u.friendsIcons?"pi-on":"pi-off",u.friendsIcons?$(".un ~ .pi-friendsIcons").show():$(".un ~ .pi-friendsIcons").hide();break;case"bg":pi._tool.modal(!0,"custom-bg");break;case"old-chat":u.oldChat=!u.oldChat,pi.dom.oldChat.className=u.oldChat?"pi-on":"pi-off",pi.toggleStyle("oldChat");break;case"old-footer":u.oldFooter=!u.oldFooter,pi.dom.oldFooter.className=u.oldFooter?"pi-on":"pi-off",pi.toggleStyle("oldFooter");break;case"small-history":u.smallHistory=!u.smallHistory,pi.dom.smallHistory.className=u.smallHistory?"pi-on":"pi-off",pi.toggleStyle("smallHistory");break;case"small-friends":u.smallFriends=!u.smallFriends,pi.dom.smallFriends.className=u.smallFriends?"pi-on":"pi-off",pi.toggleStyle("smallFriends");break;case"small-playlists":u.smallPlaylists=!u.smallPlaylists,pi.dom.smallPlaylists.className=u.smallPlaylists?"pi-on":"pi-off",pi.toggleStyle("smallPlaylists");break;case"showDeletedMsg":u.showDeletedMsg=!u.showDeletedMsg,pi.dom.showDeletedMsg.className=u.showDeletedMsg?"pi-on":"pi-off",u.showDeletedMsg?$(".cm.deleted").show():$(".cm.deleted").hide();break;case"confirmDelete":u.confirmDelete=!u.confirmDelete,pi.dom.confirmDelete.className=u.confirmDelete?"pi-on":"pi-off";break;case"userInfo":u.userInfo=!u.userInfo,pi.dom.userInfo.className=u.userInfo?"pi-on":"pi-off",u.userInfo?$(".un ~ .userInfo").show():$(".un ~ .userInfo").hide();break;case"stuckSkip":u.stuckSkip=!u.stuckSkip,pi.dom.stuckSkip.className=u.stuckSkip?"pi-on":"pi-off";break;case"lengthA":u.songLimit=!u.songLimit,pi.dom.lengthA.className=u.songLimit?"pi-on":"pi-off";break;case"historyA":u.historyAlert=!u.historyAlert,pi.dom.historyAlert.className=u.historyAlert?"pi-on":"pi-off";break;case"systemNotifications":u.systemNotifications=!u.systemNotifications,pi.dom.systemNotifications.className=u.systemNotifications?"pi-on":"pi-off",u.systemNotifications&&"default"==Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)});break;case"songStats":u.songStats=!u.songStats,pi.dom.songStats.className=u.songStats?"pi-on":"pi-off";break;case"boothAlert":u.boothAlert=!u.boothAlert,pi.dom.boothAlert.className=u.boothAlert?"pi-on":"pi-off";break;case"userJoin":u.userJoin=!u.userJoin,pi.dom.userJoin.className=u.userJoin?"pi-on":"pi-off";break;case"userLeave":u.userLeave=!u.userLeave,pi.dom.userLeave.className=u.userLeave?"pi-on":"pi-off";break;case"userWoot":u.userWoot=!u.userWoot,pi.dom.userWoot.className=u.userWoot?"pi-on":"pi-off";break;case"userGrab":u.userGrab=!u.userGrab,pi.dom.userGrab.className=u.userGrab?"pi-on":"pi-off";break;case"userMeh":u.userMeh=!u.userMeh,pi.dom.mehA.className=u.userMeh?"pi-on":"pi-off";break;case"guestJoin":u.guestJoin=!u.guestJoin,pi.dom.guestJoin.className=u.guestJoin?"pi-on":"pi-off";break;case"guestLeave":u.guestLeave=!u.guestLeave,pi.dom.guestLeave.className=u.guestLeave?"pi-on":"pi-off";break;case"friendRoomChange":u.friendRoomChange=!u.friendRoomChange,pi.dom.friendRoomChange.className=u.friendRoomChange?"pi-on":"pi-off";break;case"friendConnect":u.friendConnect=!u.friendConnect,pi.dom.friendConnect.className=u.friendConnect?"pi-on":"pi-off";break;case"friendDisconnect":u.friendDisconnect=!u.friendDisconnect,pi.dom.friendDisconnect.className=u.friendDisconnect?"pi-on":"pi-off";break;case"unfriended":u.unfriended=!u.unfriended,pi.dom.unfriended.className=u.unfriended?"pi-on":"pi-off";break;case"gainNotification":u.gainNotification=!u.gainNotification,pi.dom.gainNotification.className=u.gainNotification?"pi-on":"pi-off";break;case"userLevelUp":u.userLevelUp=!u.userLevelUp,pi.dom.userLevelUp.className=u.userLevelUp?"pi-on":"pi-off";break;case"init":pi.dom.woot.className=u.autoW?"pi-on":"pi-off",pi.autowoot(),pi.dom.join.className=u.autoDJ?"pi-on":"pi-off",pi.autojoin(),pi.dom.keyShortcut.className=u.keyboardShortcuts?"pi-on":"pi-off",pi.dom.chatCommands.className=u.chatCommands?"pi-on":"pi-off",pi.dom.autoHideLogs.className=u.autoHideLogs?"pi-on":"pi-off",pi.dom.betterMeh.className=u.betterMeh?"pi-on":"pi-off",pi.dom.afkResponder.className=u.afk?"pi-on":"pi-off",pi.dom.afkMessage.children[0].value=u.afkMessage,pi.afk(),pi.dom.navWarn.className=u.navWarn?"pi-on":"pi-off",pi.dom.showVotes.className=u.showVotes?"pi-on":"pi-off",pi.dom.betterClearChatLimit.children[0].value=u.betterClearChatLimit,pi.dom.chatLimit.children[0].value=u.chatLimit,pi.dom.skipNextMediaInHistory.className=u.skipNextMediaInHistory?"pi-on":"pi-off",pi.dom.video.className=u.showVideo?"pi-off":"pi-on",pi.hideStream(),pi.dom.soundcloudVisu.className=u.scVisu?"pi-on":"pi-off",pi.dom.css.className=u.CSS?"pi-on":"pi-off",pi.toggleStyle("customStyle"),pi.dom.customRanks.className=u.customRanks?"pi-on":"pi-off",pi.toggleStyle("customRanks"),pi.dom.languageFlags.className=u.languageFlags?"pi-on":"pi-off",pi.dom.friendsIcons.className=u.friendsIcons?"pi-on":"pi-off",null!==u.customBGURL&&pi.changeBG(!1,u.customBGURL),pi.dom.oldChat.className=u.oldChat?"pi-on":"pi-off",pi.toggleStyle("oldChat"),pi.dom.oldFooter.className=u.oldFooter?"pi-on":"pi-off",pi.toggleStyle("oldFooter"),pi.dom.smallHistory.className=u.smallHistory?"pi-on":"pi-off",pi.toggleStyle("smallHistory"),pi.dom.smallFriends.className=u.smallFriends?"pi-on":"pi-off",pi.toggleStyle("smallFriends"),pi.dom.smallPlaylists.className=u.smallPlaylists?"pi-on":"pi-off",pi.toggleStyle("smallPlaylists"),pi.dom.showDeletedMsg.className=u.showDeletedMsg?"pi-on":"pi-off",pi.dom.confirmDelete.className=u.confirmDelete?"pi-on":"pi-off",pi.dom.userInfo.className=u.userInfo?"pi-on":"pi-off",pi.dom.stuckSkip.className=u.stuckSkip?"pi-on":"pi-off",pi.dom.lengthA.className=u.songLimit?"pi-on":"pi-off",pi.dom.songLength.children[0].value=u.songLength,pi.dom.historyAlert.className=u.historyAlert?"pi-on":"pi-off",pi.dom.systemNotifications.className=u.systemNotifications?"pi-on":"pi-off",pi.dom.songStats.className=u.songStats?"pi-on":"pi-off",pi.dom.boothAlert.className=u.boothAlert?"pi-on":"pi-off",pi.dom.boothPosition.children[0].value=u.boothPosition,pi.dom.userJoin.className=u.userJoin?"pi-on":"pi-off",pi.dom.userLeave.className=u.userLeave?"pi-on":"pi-off",pi.dom.userWoot.className=u.userWoot?"pi-on":"pi-off",pi.dom.userGrab.className=u.userGrab?"pi-on":"pi-off",pi.dom.mehA.className=u.userMeh?"pi-on":"pi-off",pi.dom.guestJoin.className=u.guestJoin?"pi-on":"pi-off",pi.dom.guestLeave.className=u.guestLeave?"pi-on":"pi-off",pi.dom.friendRoomChange.className=u.friendRoomChange?"pi-on":"pi-off",pi.dom.friendConnect.className=u.friendConnect?"pi-on":"pi-off",pi.dom.friendDisconnect.className=u.friendDisconnect?"pi-on":"pi-off",pi.dom.unfriended.className=u.unfriended?"pi-on":"pi-off",pi.dom.gainNotification.className=u.gainNotification?"pi-on":"pi-off",pi.dom.gainNotificationMinXP.children[1].value=u.minimumGain.xp,pi.dom.gainNotificationMinPP.children[1].value=u.minimumGain.pp,pi.dom.userLevelUp.className=u.userLevelUp?"pi-on":"pi-off";break;case"off":pi._tool.saveSettings(),pi._close();break;default:pi._tool.log("Unrecognized menu string: "+e,"console error")}"off"!==e&&pi._tool.saveSettings()},muteMeh:function(){function e(){API.setVolume(o),API.off(API.ADVANCE,e),$("#woot").off("click",e),$("#meh").one("click",t)}function t(){$("#meh").hasClass("disabled")||(o=API.getVolume(),API.setVolume(0),API.once(API.ADVANCE,e),$("#woot").one("click",e))}var o=API.getVolume();u.betterMeh?$("#meh").one("click",t):$("#meh").off("click",t)},removeDJ:function(){"false"==sessionStorage.getItem("modQuitWarn")?(sessionStorage.setItem("modQuitWarn","true"),pi._tool.log(a.warn.confirmEject,"warn chat")):(sessionStorage.setItem("modQuitWarn","false"),API.moderateForceQuit())},songLimit:function(){u.songLimit&&void 0!==API.getMedia()&&API.getMedia().duration>u.songLength&&pi._tool.log(pi._tool.replaceString(a.warn.songLimit,{max:u.songLength}),"warn chat")},soundcloudVisu:function(e){var t=$("#sc-frame"),o=$("#pi-frame");if(void 0===e&&(e=API.getMedia()),1===e.format&&$("#pi-frame").is(":visible"))return o.hide();if(1!==e.format)if(u.scVisu&&!pi._tool.getPlugSettings().streamDisabled){var i=Math.floor(Math.random()*d.visu.length);t.hide(),o.show(),o[0].src=d.visu[i]}else t.show(),o.hide()},toggleStyle:function(e){switch(e){case"roomStyle":if(u.roomStyle){var t=$('<link id="pi-custom-room-style" rel="stylesheet" type="text/css" href="'+g.css+'">');$("head").append(t)}else $("#pi-custom-room-style").remove();break;case"customStyle":u.CSS?($("head").append($('<link id="pi-CSS" rel="stylesheet" type="text/css" href="'+d.styles.blue_css+'">')),pi.changeBG(!1,null!==u.customBGURL?u.customBGURL:d.images.background)):($("#pi-CSS").remove(),pi.changeBG(!0));break;case"customRanks":u.customRanks?$("head").append($('<link id="pi-custom_ranks" rel="stylesheet" type="text/css" href="'+d.styles.custom_ranks+'">')):$("#pi-custom_ranks").remove();break;case"oldChat":u.oldChat?$("head").append($('<link id="pi-oldchat-CSS" rel="stylesheet" type="text/css" href="'+d.styles.old_chat+'">')):$("#pi-oldchat-CSS").remove(),window.WiBla={listen:"always",rulesTheWorld:"not yet :troll:",isOnFire:function(){console.log("%c                '@@             `.     @'          \n%c     @@         @@@   @,    :'@@@@@#   @@          \n%c     @@         @@;  +@@   @@@@@@@@@  ,@@          \n%c    +@@    `    @@   :@+   @@@;  `@@  @@@          \n%c    @@@   @@.   @@         @@`  `@@'  @@.          \n%c    @@    @@   ;@@   @,   .@@ `@@@+   @@     ;@@@` \n%c   +@@   ;@@   @@+  @@@   @@@@@@@    ,@@    @@@@@@ \n%c   @@+   @@@   @@   @@:   @@@@@@,    @@@   @@@@@@; \n%c   @@   ;@@;  :@@   @@    @@@@@@@@   @@.  #@@, @@  \n%c  '@@   @@@,  @@.  ,@@   +@@   ,@@.  @@   @@; :@@  \n%c  @@@  @@@@, `@@   @@@   @@;    @@  :@@  ,@@ ,@@@  \n%c  @@; :@@@@+ @@`   @@,   @@   #@@@  @@@  @@@#@@@;  \n%c  @@.`@@ ;@@@@@    @@   +@@@@@@@'   @@'  ;@@@@@@   \n%c  @@@@@   @@@@     @@   +@@@@@'     @@,   @@@ @@   \n%c  :@@@     @:      ',               `#             ","color: hsl(210,0%,0%);   text-shadow: 0 0 20px","color: hsl(210,5%,5%);   text-shadow: 0 0 20px","color: hsl(210,10%,10%); text-shadow: 0 0 20px","color: hsl(210,15%,15%); text-shadow: 0 0 20px","color: hsl(210,20%,20%); text-shadow: 0 0 20px","color: hsl(210,25%,25%); text-shadow: 0 0 20px","color: hsl(210,30%,30%); text-shadow: 0 0 20px","color: hsl(210,35%,35%); text-shadow: 0 0 20px","color: hsl(210,40%,40%); text-shadow: 0 0 20px","color: hsl(210,45%,45%); text-shadow: 0 0 20px","color: hsl(210,50%,50%); text-shadow: 0 0 20px","color: hsl(215,50%,50%); text-shadow: 0 0 20px","color: hsl(220,50%,50%); text-shadow: 0 0 20px","color: hsl(225,50%,50%); text-shadow: 0 0 20px","color: hsl(230,50%,50%); text-shadow: 0 0 20px")}};break;case"oldFooter":u.oldFooter?$("head").append($('<link id="pi-oldfooter-CSS" rel="stylesheet" type="text/css" href="'+d.styles.old_footer+'">')):$("#pi-oldfooter-CSS").remove();break;case"smallHistory":u.smallHistory?$("head").append($('<link id="pi-smallHistory-CSS" rel="stylesheet" type="text/css" href="'+d.styles.small_history+'">')):$("#pi-smallHistory-CSS").remove();break;case"smallFriends":u.smallFriends?$("head").append($('<link id="pi-smallFriends-CSS" rel="stylesheet" type="text/css" href="'+d.styles.small_friends+'">')):$("#pi-smallFriends-CSS").remove();break;case"smallPlaylists":u.smallPlaylists?$("head").append($('<link id="pi-smallPlaylists-CSS" rel="stylesheet" type="text/css" href="'+d.styles.small_playlists+'">')):$("#pi-smallPlaylists-CSS").remove()}},voteAlert:function(e){var t=u.userInfo?" Lvl:"+e.user.level+"|Id:"+e.user.id:"";void 0===e.vote&&e.user.grab&&u.userGrab?pi._tool.log(pi._tool.replaceString(a.log.grabbed,{user:e.user.username,userInfo:t}),"chat"):1==e.vote&&!e.user.grab&&u.userWoot?pi._tool.log(pi._tool.replaceString(a.log.wooted,{user:e.user.username,userInfo:t}),"chat"):-1==e.vote&&u.userMeh&&pi._tool.getRoomRules("allowShowingMehs")&&pi._tool.log(pi._tool.replaceString(a.log.meh,{user:e.user.username,userInfo:t}),"chat")}},pi._load()}if(/(http(?:s)?:\/\/(?:[a-z]+\.)*plug\.dj\/)(?!about$|ba$|forgot-password$|founders$|giftsub\/\d|jobs$|legal$|merch$|partners$|plot$|privacy$|purchase$|subscribe$|team$|terms$|press$|_\/|@\/|!\/)(.+)/i.test(location.href))if("undefined"!=typeof pi)pi._reload();else if("undefined"!=typeof API&&API.enabled&&"undefined"!=typeof jQuery&&"undefined"!=typeof require){$(".app-header").after($('<div id="pi-status"><img height="30px" src="https://raw.githubusercontent.com/Plug-It/pi/pre-release/img/other/icon-54.png"><span></span></div>').css({position:"absolute",top:"65px",right:"355px","text-align":"right",padding:"5px",background:"rgb(24, 28, 33)",color:"rgb(221, 221, 221)","border-radius":"5px","box-shadow":"rgb(0, 0, 0) 0px 0px 3px",transition:"all 0.25s ease-in-out","z-index":"1337"})),o("https://api.github.com/repos/Plug-It/pi/commits/pre-release",function(e){window.thisCommit=e});var a,s;switch(t("Loading language",1),API.getUser().language){case"cs":a="cs";break;case"de":a="de";break;case"et":a="et";break;case"fr":a="fr";break;case"nl":a="nl";break;case"pl":a="pl";break;case"pt":a="pt";break;case"sl":a="sl";break;case"sv":a="sv";break;default:a="en"}$.ajax({dataType:"json",url:"https://rawgit.com/Plug-It/pi/pre-release/lang/"+a+".json",success:function(e){a=e},error:function(e){console.log("[Plug-It] Error while loading translation:\n",e),API.chatLog("[Plug-It] Error while loading translation: "+e.statusText+". Check the console for more info.")}}),t("Loading script ranks",2),$.ajax({dataType:"json",url:"https://rawgit.com/Plug-It/pi/pre-release/json/ranks.json",success:function(e){s=e,i()},error:function(e){console.log("[Plug-It] Error while loading script ranks:\n",e),API.chatLog("[Plug-It] Error while loading script ranks: "+e.statusText+". Check the console for more info.")}})}else setTimeout(e,10);else{var n=function(){"/dashboard"===location.pathname&&-1!==location.origin.indexOf("plug")?setTimeout(function(){n()},1e3):e()};try{API.enabled,n()}catch(e){console.log("You are trying to run Plug-It outside of plug.dj !"),console.log(e)}}}()}();
